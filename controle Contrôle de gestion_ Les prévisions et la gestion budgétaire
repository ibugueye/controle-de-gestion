{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "32f8d6e8-4a1a-4602-9801-4211a19ec57e",
   "metadata": {},
   "source": [
    "\n",
    "# **Contrôle de gestion : Prévisions et Gestion Budgétaire**\n",
    "\n",
    "--- \n",
    "Ce guide complet de **contrôle de gestion** vous permet de construire un système de gestion budgétaire en partant de la **budgétisation des ventes**, en passant par la **production** et les **approvisionnements**, jusqu’au **budget global**. Les exemples en Excel et Python vous offrent des outils pour automatiser et optimiser ces processus. \n",
    "il s’appuie sur les concepts fondamentaux du contrôle de gestion et permet de gérer efficacement les finances et les ressources d'une entreprise.\n",
    "\n",
    "## **Introduction : Objectifs du contrôle de gestion**\n",
    "Le contrôle de gestion vise à fournir aux entreprises les outils nécessaires pour assurer une **gestion efficace des ressources**, ainsi que pour suivre et ajuster la performance en fonction des objectifs stratégiques. Il englobe les processus de **prévisions, de budgétisation et de suivi**.\n",
    "\n",
    "Ce cours se concentrera sur l'élaboration pratique des budgets suivants :\n",
    "1. **Budget des ventes**\n",
    "2. **Budget de production**\n",
    "3. **Budget des approvisionnements**\n",
    "4. **Budget global** incluant la trésorerie\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aafad473-07e1-4c06-b99a-1022e601a7e9",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "7f3d7fd8-5959-459d-a6fd-e7a46532c0db",
   "metadata": {},
   "source": [
    "\n",
    "Chaque section sera accompagnée de méthodes pratiques d'élaboration, ainsi que d'exercices réalisés à la fois en **Excel** et en **python**\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a7664b96-6978-49a4-ac6b-232cb305fa8c",
   "metadata": {},
   "source": [
    "---\n",
    "### Le Budget des Ventes : Concepts, Méthodologie et Exemple Pratique\n",
    "\n",
    "Le **budget des ventes** est le point de départ du processus de budgétisation de toute entreprise. Il s'agit de prévoir les ventes futures en volume et en valeur sur une période donnée (généralement annuelle). Ces prévisions de ventes sont cruciales, car elles déterminent tous les autres budgets tels que ceux de la production, des approvisionnements, des charges, et même le budget de trésorerie.\n",
    "\n",
    "#### Objectifs du Budget des Ventes\n",
    "\n",
    "1. **Prévoir les recettes futures** : Évaluer les revenus que l'entreprise espère générer pendant la période budgétaire.\n",
    "2. **Optimiser la gestion de l'offre** : Assurer que les services commerciaux disposent de suffisamment d’informations pour anticiper la demande.\n",
    "3. **Coordonner les autres budgets** : L'élaboration du budget des ventes conditionne l'établissement des autres budgets (production, approvisionnement, etc.).\n",
    "\n",
    "#### Étapes de l'élaboration du Budget des Ventes\n",
    "\n",
    "1. **Analyse des Ventes Historiques** :\n",
    "   - Examinez les ventes des périodes antérieures pour identifier des tendances et des motifs saisonniers. Cela vous aidera à établir une base solide pour vos prévisions.\n",
    "\n",
    "2. **Études de Marché** :\n",
    "   - Recueillez des informations sur les attentes des clients, les actions de la concurrence et les prévisions économiques. Ces informations permettent de valider ou d’ajuster les tendances passées.\n",
    "\n",
    "3. **Prévisions des Ventes** :\n",
    "   - Utilisez les données historiques, les études de marché et des méthodes statistiques (extrapolation, moyennes mobiles, coefficients saisonniers) pour estimer les ventes futures.\n",
    "\n",
    "4. **Évaluation des Risques** :\n",
    "   - Identifiez les facteurs de risques qui peuvent affecter les prévisions (comme des changements économiques, des modifications dans la réglementation, des tendances de consommation, etc.) et ajustez vos prévisions en conséquence.\n",
    "\n",
    "5. **Construction du Tableau de Budget des Ventes** :\n",
    "   - Construisez un tableau détaillé des ventes attendues, mois par mois, en prenant en compte les quantités de produits à vendre, les prix de vente et la TVA applicable.\n",
    "\n",
    "### Méthodologie de Calcul\n",
    "\n",
    "Le budget des ventes est généralement exprimé en **valeur hors taxes (HT)** et peut inclure des informations telles que :\n",
    "- Quantités prévues à vendre pour chaque produit.\n",
    "- Prix de vente unitaire par produit.\n",
    "- Chiffre d'affaires attendu (quantité × prix unitaire).\n",
    "- Taxes à ajouter pour obtenir le chiffre d'affaires total TTC (toutes taxes comprises).\n",
    "\n",
    "### Exemple Pratique : Calcul du Budget des Ventes\n",
    "\n",
    "#### Hypothèses de base\n",
    "\n",
    "- **Produits** : Produit A et Produit B.\n",
    "- **Quantités prévues** :\n",
    "  - Produit A : 500 unités/mois\n",
    "  - Produit B : 300 unités/mois\n",
    "- **Prix de vente unitaire HT** :\n",
    "  - Produit A : 100 €\n",
    "  - Produit B : 150 €\n",
    "- **TVA** : 20%\n",
    "\n",
    "#### Calcul Mois par Mois\n",
    "\n",
    "Nous allons créer un tableau du budget des ventes pour les trois premiers mois d'une année fictive.\n",
    "\n",
    "### Exemple en Python\n",
    "\n",
    "Voici un exemple de code Python pour calculer le budget des ventes :\n",
    "\n",
    "```python\n",
    "import pandas as pd\n",
    "\n",
    "def calcul_budget_ventes():\n",
    "    # Données de base\n",
    "    produits = [\"Produit A\", \"Produit B\"]\n",
    "    prix_vente_HT = [100, 150]  # en euros\n",
    "    quantites_prevues = {\n",
    "        \"Janvier\": [500, 300],\n",
    "        \"Février\": [520, 310],\n",
    "        \"Mars\": [530, 320]\n",
    "    }\n",
    "    tva = 0.2\n",
    "    \n",
    "    # Tableau des ventes\n",
    "    budget_ventes = []\n",
    "    \n",
    "    # Calculer pour chaque mois\n",
    "    for mois, quantites in quantites_prevues.items():\n",
    "        ventes_HT = []\n",
    "        ventes_TTC = []\n",
    "        \n",
    "        for i in range(len(produits)):\n",
    "            vente_HT = quantites[i] * prix_vente_HT[i]\n",
    "            vente_TTC = vente_HT * (1 + tva)\n",
    "            \n",
    "            ventes_HT.append(vente_HT)\n",
    "            ventes_TTC.append(vente_TTC)\n",
    "        \n",
    "        total_HT = sum(ventes_HT)\n",
    "        total_TTC = sum(ventes_TTC)\n",
    "        \n",
    "        budget_ventes.append([mois, ventes_HT[0], ventes_HT[1], total_HT, total_TTC])\n",
    "    \n",
    "    # Créer un DataFrame pour afficher les résultats\n",
    "    df_ventes = pd.DataFrame(budget_ventes, columns=[\"Mois\", \"Ventes Produit A HT\", \"Ventes Produit B HT\", \"Total HT\", \"Total TTC\"])\n",
    "    \n",
    "    return df_ventes\n",
    "\n",
    "# Affichage du tableau de budget des ventes\n",
    "df_budget_ventes = calcul_budget_ventes()\n",
    "print(df_budget_ventes)\n",
    "```\n",
    "\n",
    "### Résultats attendus du code Python :\n",
    "\n",
    "Le tableau affichera les ventes prévues pour chaque mois, avec les colonnes suivantes :\n",
    "- Ventes HT pour Produit A.\n",
    "- Ventes HT pour Produit B.\n",
    "- Total des ventes HT (Produit A + Produit B).\n",
    "- Total des ventes TTC.\n",
    "\n",
    "| Mois     | Ventes Produit A HT | Ventes Produit B HT | Total HT | Total TTC |\n",
    "|----------|---------------------|---------------------|----------|-----------|\n",
    "| Janvier  | 50 000 €            | 45 000 €            | 95 000 € | 114 000 € |\n",
    "| Février  | 52 000 €            | 46 500 €            | 98 500 € | 118 200 € |\n",
    "| Mars     | 53 000 €            | 48 000 €            | 101 000 €| 121 200 € |\n",
    "\n",
    "### Explication des Concepts et Formules\n",
    "\n",
    "- **Prix de Vente HT** : C’est le prix auquel un produit est vendu sans inclure les taxes.\n",
    "- **Ventes en HT** : Calculé en multipliant le prix de vente unitaire HT par la quantité vendue.\n",
    "- **Ventes TTC** : Calculé en ajoutant la TVA au montant HT, ce qui donne le montant total à payer par le client.\n",
    "$$\n",
    "  \\text{Ventes TTC} = \\text{Ventes HT} \\times (1 + \\text{TVA})\n",
    " $$\n",
    "### Conclusion\n",
    "\n",
    "Le **budget des ventes** permet à l'entreprise d'anticiper ses recettes et de coordonner la production en fonction des volumes prévus. L'exemple en Python permet de calculer rapidement les montants HT et TTC à partir des prévisions de vente, ce qui est une étape cruciale pour la gestion budgétaire de toute entreprise.\n",
    "\n",
    "Cela forme la base pour continuer la budgétisation de la production, des approvisionnements, et des autres éléments de gestion financière."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b047f6ae-463b-43ba-8f41-49c04ade510e",
   "metadata": {},
   "source": [
    "\n",
    "--\n",
    "# Le budget d'approvisionnement\n",
    "\n",
    "Le budget d'approvisionnement consiste à prévoir et à gérer les coûts associés à l'acquisition, à la gestion et à la possession des stocks nécessaires au fonctionnement d'une entreprise. Il comprend plusieurs composantes essentielles, telles que le coût d'achat, le coût de possession, le coût de lancement et le coût de pénurie. Chaque composante impacte le budget global et la gestion des stocks.\n",
    "\n",
    "### Les coûts de l'approvisionnement\n",
    "\n",
    "#### Coût d'achat\n",
    "Ce coût correspond au prix d'achat des biens, y compris les frais accessoires (transport, douanes, etc.). C'est le montant que l'entreprise doit payer pour acquérir les biens ou matières premières.\n",
    "\n",
    "#### Coût de possession\n",
    "Le coût de possession inclut les frais liés au stockage des stocks. Cela comprend des frais tels que :\n",
    "- **Le coût du stockage** : Cela inclut le coût de location ou d’amortissement des bâtiments de stockage, les frais de gardiennage, les assurances, et les coûts de financement.\n",
    "- **Formule du coût de possession** : Ce coût est généralement calculé en fonction du stock moyen. Par exemple, une entreprise pourrait dépenser 232 500 € pour des frais de stockage annuels, avec une valeur moyenne de stock de 1 150 000 €, ce qui correspond à un taux de possession annuel de 20,22 %.\n",
    "\n",
    "#### Coût de lancement\n",
    "Ce coût couvre les dépenses liées à la commande de nouveaux stocks, telles que les frais administratifs pour chaque commande. Par exemple, si une entreprise commande 40 fois par an avec un coût de traitement de 350 € par commande, le coût annuel de lancement sera de 14 000 €.\n",
    "\n",
    "#### Coût de pénurie\n",
    "Ce coût survient lorsque l’entreprise n’a pas suffisamment de stock pour répondre à la demande, entraînant une perte potentielle de revenus ou des coûts supplémentaires pour remédier à la rupture de stock. Il inclut des coûts proportionnels au nombre de ruptures, aux unités manquantes, et à la durée de la pénurie.\n",
    "\n",
    "### Les modèles de gestion des stocks\n",
    "\n",
    "#### Modèle déterministe : Le modèle de Wilson\n",
    "Le modèle de Wilson est une méthode de gestion des stocks qui présume que la demande et les délais de livraison sont connus à l'avance. Il est utilisé pour déterminer la quantité optimale de commande qui minimise les coûts d'approvisionnement. Par exemple, une entreprise pourrait déterminer que le lot économique optimal est de 5 761 unités, avec un coût de possession de 31 109 € et un coût de lancement de 31 102 €, ce qui mène à un coût total de gestion des stocks de 62 211 €.\n",
    "\n",
    "En prenant en compte les pénuries, on peut ajuster ce modèle en augmentant la quantité optimale de commande pour inclure les coûts de pénurie.\n",
    "\n",
    "### Budgétisation des approvisionnements\n",
    "\n",
    "Il existe deux approches principales pour budgétiser les approvisionnements :\n",
    "\n",
    "#### Budgétisation par périodes constantes\n",
    "Dans cette méthode, les commandes sont passées à des intervalles réguliers. Par exemple, une entreprise ayant des prévisions de consommation de janvier à juin pourrait passer une commande tous les mois et demi. Dans cet exemple, la quantité optimale de commande est de 2 000 unités, avec quatre commandes réparties sur six mois.\n",
    "\n",
    "#### Budgétisation par quantités constantes\n",
    "Dans cette approche, la quantité de chaque commande reste fixe (par exemple, 2 000 unités), mais les dates des commandes varient en fonction des besoins en stock. Par exemple, si l’entreprise commence avec 800 unités en stock en janvier et qu’elle prévoit une rupture fin janvier, elle passerait une commande de 2 000 unités à la mi-janvier pour éviter une pénurie.\n",
    "\n",
    "### Exemples pratiques\n",
    "Prenons l'exemple d'une entreprise qui consomme 300 000 kg de matières premières par an. Si elle commande 7 500 kg à chaque commande, elle passerait 40 commandes par an, avec un coût de passation annuel de 14 000 €. Si cette entreprise applique le modèle de Wilson, elle pourrait réduire ses coûts en ajustant la taille de ses lots de commande pour minimiser les coûts de possession et de lancement.\n",
    "\n",
    "En conclusion, la budgétisation des approvisionnements est essentielle pour optimiser la gestion des stocks en minimisant les coûts d'achat, de possession, de lancement et de pénurie, tout en s'assurant que l'entreprise dispose toujours des stocks nécessaires pour répondre à la demande."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "607ee0de-21e8-4ae2-98a7-9eb9133a1fca",
   "metadata": {},
   "source": [
    "## Application \n",
    "### Le budget d'approvisionnement\n",
    "\n",
    "Le budget d'approvisionnement regroupe l'ensemble des coûts liés à l'acquisition, la gestion et la conservation des stocks dans une entreprise. Il inclut les coûts d'achat, de possession, de lancement, ainsi que les coûts engendrés par les pénuries.\n",
    "\n",
    "#### Les coûts de l'approvisionnement\n",
    "\n",
    "##### 1. Le coût d'achat\n",
    "Le coût d'achat comprend le prix d'achat des produits ou matières premières ainsi que tous les frais accessoires liés à cet achat, tels que les frais de transport, douanes, ou autres coûts indirects.\n",
    "\n",
    "##### 2. Le coût de possession\n",
    "Le coût de possession, également appelé coût de stockage, se rapporte aux frais encourus pour maintenir un stock. Il inclut :\n",
    "- **Les frais de gardiennage et de manutention**\n",
    "- **Les primes d’assurance**\n",
    "- **Le coût de financement**\n",
    "- **La valeur du stock moyen**\n",
    "\n",
    "Pour calculer le coût de possession, il faut d’abord déterminer le stock moyen. Celui-ci est donné par la formule :  \n",
    "**Stock moyen = Stock de sécurité + (Quantité commandée / 2)**  \n",
    "Ensuite, le coût de possession est calculé à partir du stock moyen multiplié par le coût unitaire de stockage.\n",
    "\n",
    "**Exemple** :  \n",
    "Une entreprise utilise des locaux d’une valeur de 200 000 € pour stocker ses matières premières. Les frais supplémentaires incluent :\n",
    "- Frais de gardiennage : 25 000 €\n",
    "- Primes d’assurance : 5 000 €\n",
    "- Coût de financement : 2 500 €\n",
    "- Valeur du stock au début de l’année : 1 000 000 €\n",
    "- Valeur du stock à la fin de l’année : 1 300 000 €\n",
    "\n",
    "Le coût de stockage annuel est alors de 232 500 €, et la valeur moyenne du stock est de 1 150 000 €, ce qui correspond à un taux de possession annuel de 20,22 %.\n",
    "\n",
    "##### 3. Le coût de lancement\n",
    "Le coût de lancement concerne les dépenses liées à chaque commande de réapprovisionnement. Il inclut généralement les frais administratifs nécessaires pour passer une commande.\n",
    "\n",
    "**Formule** :  \n",
    "Le coût de lancement est calculé par la formule :  \n",
    "**Coût de lancement total = Coût unitaire de lancement × Nombre de commandes**\n",
    "\n",
    "**Exemple** :  \n",
    "Une entreprise consomme 300 000 kg de matières premières par an, avec des commandes de 7 500 kg chacune. Le nombre total de commandes par an est de 40, et si le coût administratif par commande est de 350 €, le coût total de lancement est de 14 000 € par an.\n",
    "\n",
    "##### 4. Le coût de pénurie\n",
    "Le coût de pénurie survient lorsque les stocks ne sont pas suffisants pour répondre à la demande. Ces coûts sont liés :\n",
    "- Au nombre de ruptures\n",
    "- Aux unités manquantes\n",
    "- À la durée de la pénurie\n",
    "\n",
    "Ces pénuries peuvent causer des pertes de revenus et entraîner des coûts supplémentaires pour réapprovisionner rapidement ou compenser la rupture.\n",
    "\n",
    "#### Les modèles de gestion des stocks\n",
    "\n",
    "##### 1. Modèle de gestion par la loi de Pareto (loi des 20/80)\n",
    "Cette méthode suggère que 20 % des références stockées représentent 80 % de la valeur totale du stock. C’est une manière de classifier les références en fonction de leur importance et de leur valeur.\n",
    "\n",
    "##### 2. Modèle de Wilson\n",
    "Le modèle de Wilson est un modèle déterministe qui suppose que la demande et les délais de livraison sont connus avec certitude à l’avance. Il permet de calculer la quantité optimale de commande qui minimise les coûts totaux d’approvisionnement (coûts de stockage et de lancement).\n",
    "\n",
    "**Exemple de calcul** :  \n",
    "Si une entreprise consomme 320 000 unités par an, et que le coût de stockage par unité est de 0,90 € par mois, avec un coût de lancement de commande de 560 €, la quantité économique à commander est de 5 761 unités.\n",
    "\n",
    "#### La budgétisation des approvisionnements\n",
    "\n",
    "Il existe deux grandes méthodes de budgétisation des approvisionnements : par périodes constantes et par quantités constantes.\n",
    "\n",
    "##### 1. La budgétisation par périodes constantes\n",
    "Dans cette méthode, les commandes sont passées à des intervalles réguliers. Les quantités commandées peuvent varier en fonction des prévisions de consommation, mais les périodes entre les commandes restent fixes.\n",
    "\n",
    "**Exemple** :  \n",
    "Une entreprise prévoit de consommer 8 000 unités sur six mois avec des prévisions mensuelles variant de 800 à 2 400 unités. Le modèle propose de passer quatre commandes de 2 000 unités chacune à intervalles réguliers de 1,5 mois.\n",
    "\n",
    "##### 2. La budgétisation par quantités constantes\n",
    "Ici, les commandes sont toujours du même volume, mais les dates de commandes sont irrégulières, en fonction des besoins en stocks. Cette méthode est utilisée pour minimiser les risques de rupture tout en optimisant les quantités commandées.\n",
    "\n",
    "**Exemple** :  \n",
    "Avec un stock initial de 800 unités en janvier, une entreprise doit commander 2 000 unités mi-janvier pour éviter une rupture. Elle continue ensuite de passer des commandes en fonction des prévisions de consommation et du stock restant.\n",
    "\n",
    "### Conclusion\n",
    "Le budget des approvisionnements est un outil clé pour gérer efficacement les stocks dans une entreprise. Il permet de minimiser les coûts tout en assurant la disponibilité des produits pour répondre à la demande. Les entreprises doivent choisir entre différentes méthodes de gestion des stocks et de budgétisation en fonction de leur structure, de leurs besoins et de leurs contraintes spécifiques.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a5d7cdf-d39c-4de7-8283-09490a0fab76",
   "metadata": {},
   "source": [
    "### Exemple de calcul du budget d'approvisionnement en Python\n",
    "**le budget d'approvisionnement avec un script qui calcule les différents coûts (coût de possession, coût de lancement, coût de pénurie, etc.) et optimise la gestion des stocks** \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "04b223fb-d0d8-4235-bfd6-6ec4562437e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "import math\n",
    "\n",
    "# Définir les variables pour l'exemple\n",
    "consommation_annuelle = 320000  # consommation annuelle en unités\n",
    "cout_stockage_unite_mois = 0.90  # coût de stockage par unité par mois en euros\n",
    "cout_lancement_commande = 560  # coût de lancement d'une commande en euros\n",
    "\n",
    "# Calcul du lot économique de commande (modèle de Wilson)\n",
    "def calcul_lot_economique(consommation_annuelle, cout_stockage_unite_mois, cout_lancement_commande):\n",
    "    cout_stockage_unite_an = cout_stockage_unite_mois * 12  # Convertir le coût de stockage à l'année\n",
    "    q_optimal = math.sqrt((2 * consommation_annuelle * cout_lancement_commande) / cout_stockage_unite_an)\n",
    "    return q_optimal\n",
    "\n",
    "# Calcul du nombre optimal de commandes\n",
    "def calcul_nombre_commandes_optimum(consommation_annuelle, q_optimal):\n",
    "    nombre_commandes = consommation_annuelle / q_optimal\n",
    "    return nombre_commandes\n",
    "\n",
    "# Calcul du coût de possession\n",
    "def calcul_cout_possession(q_optimal, cout_stockage_unite_an):\n",
    "    cout_possession = (q_optimal / 2) * cout_stockage_unite_an\n",
    "    return cout_possession\n",
    "\n",
    "# Calcul du coût de lancement total\n",
    "def calcul_cout_lancement_total(nombre_commandes, cout_lancement_commande):\n",
    "    cout_lancement_total = nombre_commandes * cout_lancement_commande\n",
    "    return cout_lancement_total\n",
    "\n",
    "# Calcul du coût total de gestion des stocks\n",
    "def calcul_cout_total_gestion_stocks(cout_possession, cout_lancement_total):\n",
    "    cout_total = cout_possession + cout_lancement_total\n",
    "    return cout_total\n",
    "\n",
    "# Application des formules\n",
    "q_optimal = calcul_lot_economique(consommation_annuelle, cout_stockage_unite_mois, cout_lancement_commande)\n",
    "nombre_commandes_optimum = calcul_nombre_commandes_optimum(consommation_annuelle, q_optimal)\n",
    "cout_stockage_unite_an = cout_stockage_unite_mois * 12  # Conversion du coût de stockage mensuel à l'année\n",
    "cout_possession = calcul_cout_possession(q_optimal, cout_stockage_unite_an)\n",
    "cout_lancement_total = calcul_cout_lancement_total(nombre_commandes_optimum, cout_lancement_commande)\n",
    "cout_total_gestion_stocks = calcul_cout_total_gestion_stocks(cout_possession, cout_lancement_total)\n",
    " \n",
    "# Affichage des résultats\n",
    "# print(f\"Quantité optimale à commander (q*): {q_optimal:.2f} unités\")\n",
    "#print(f\"Nombre optimal de commandes par an: {nombre_commandes_optimum:.2f}\")\n",
    "#print(f\"Coût de possession annuel: {cout_possession:.2f} €\")\n",
    "#print(f\"Coût de lancement total annuel: {cout_lancement_total:.2f} €\")\n",
    "#print(f\"Coût total de gestion des stocks: {cout_total_gestion_stocks:.2f} €\")\n",
    "\n",
    " "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9966b4e4-0cbb-40dd-b61f-ae70ca4fa2a8",
   "metadata": {},
   "source": [
    "\n",
    "### Explication du code :\n",
    "1. **Calcul du lot économique de commande (q\\*)** : On utilise la formule de Wilson pour déterminer la quantité optimale de commande qui minimise les coûts de stockage et de lancement.\n",
    "   \n",
    "$$\n",
    "   q^* = \\sqrt{\\frac{2 \\times \\text{consommation annuelle} \\times \\text{coût de lancement}}{\\text{coût de stockage unitaire annuel}}}\n",
    "$$\n",
    "\n",
    "2. **Nombre optimal de commandes** : On calcule combien de commandes il faudrait passer chaque année avec le lot économique.\n",
    "\n",
    "$$\n",
    "   N = \\frac{\\text{consommation annuelle}}{q^*}\n",
    "$$\n",
    "\n",
    "3. **Coût de possession** : Il est calculé sur la base de la quantité optimale de commande et du coût de stockage unitaire.\n",
    "\n",
    "4. **Coût de lancement total** : Ce coût est le résultat du coût unitaire de lancement multiplié par le nombre de commandes.\n",
    "\n",
    "5. **Coût total de gestion des stocks** : Il s'agit de la somme des coûts de possession et de lancement.\n",
    "\n",
    "### Affichage des résultats:\n",
    " \n",
    "**Quantité optimale à commander (q***): **5760.66 unités**  \n",
    "**Nombre optimal de commandes par an: 55.54**  \n",
    "**Coût de possession annuel: 31109.01 €**  \n",
    "**Coût de lancement total annuel: 31102.00 €**  \n",
    "**Coût total de gestion des stocks: 62211.01 €**  \n",
    " \n",
    "\n",
    "Ce script donne un aperçu des principaux calculs du budget d'approvisionnement et aide à déterminer la quantité optimale de commande pour minimiser les coûts de gestion des stocks. Vous pouvez ajuster les valeurs pour correspondre aux spécificités de votre entreprise ou ajouter d'autres coûts comme les coûts de pénurie."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dd686cd9-a7e9-4949-896c-b9e50a2d2d12",
   "metadata": {},
   "source": [
    "le modèle déterministe avec prise en compte de la pénurie et la budgétisation dans notre traitement Python, nous devons introduire des calculs supplémentaires pour gérer les pénuries et modéliser la budgétisation par périodes constantes et par quantités constantes. Voici comment cela peut être fait :\n",
    "\n",
    "### Modèle déterministe avec prise en compte de la pénurie\n",
    "\n",
    "Le modèle de Wilson peut être ajusté pour inclure un facteur de pénurie. La formule ajustée est :\n",
    "\n",
    "$$\n",
    "q^* = \\sqrt{\\frac{2 \\times Q \\times \\text{Coût de lancement}}{\\text{Coût de stockage}}} \\times \\frac{\\text{Coût de pénurie} + \\text{Coût de stockage}}{\\text{Coût de pénurie}}\n",
    "$$\n",
    "\n",
    "Où :\n",
    "- `Q` est la consommation annuelle\n",
    "- `Coût de pénurie` est le coût par unité manquante\n",
    "\n",
    "### La budgétisation des approvisionnements\n",
    "\n",
    "Pour la budgétisation, nous allons gérer deux cas :\n",
    "1. **Budgétisation par périodes constantes** : On passe des commandes à intervalles réguliers.\n",
    "2. **Budgétisation par quantités constantes** : On passe des commandes de quantités fixes à des intervalles irréguliers.\n",
    "\n",
    "\n",
    "### Code Python pour inclure ces fonctionnalités du Modèle déterministe avec prise en compte de la pénurie"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "b31ea4d6-eec9-4209-a202-d753a675bfdf",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true
   },
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "import math\n",
    "\n",
    "# Définir les variables pour l'exemple\n",
    "consommation_annuelle = 320000  # consommation annuelle en unités\n",
    "cout_stockage_unite_mois = 0.90  # coût de stockage par unité par mois en euros\n",
    "cout_lancement_commande = 560  # coût de lancement d'une commande en euros\n",
    "cout_penurie = 67  # coût par unité manquante par an\n",
    "\n",
    "# Modèle déterministe avec prise en compte de la pénurie\n",
    "def calcul_lot_economique_penurie(consommation_annuelle, cout_stockage_unite_mois, cout_lancement_commande, cout_penurie):\n",
    "    cout_stockage_unite_an = cout_stockage_unite_mois * 12  # Convertir le coût de stockage à l'année\n",
    "    facteur_penurie = (cout_penurie + cout_stockage_unite_an) / cout_penurie\n",
    "    q_optimal_penurie = math.sqrt((2 * consommation_annuelle * cout_lancement_commande) / cout_stockage_unite_an) * facteur_penurie\n",
    "    return q_optimal_penurie\n",
    "\n",
    "# Budgétisation par périodes constantes\n",
    "def budgetisation_periodes_constantes(previsions_consommation, cout_unitaire, cout_lancement, taux_possession, stock_initial, delai_livraison, stock_securite):\n",
    "    total_cout = 0\n",
    "    stock = stock_initial\n",
    "    for mois, consommation in enumerate(previsions_consommation, 1):\n",
    "        # Calcul du stock de sécurité pour chaque période\n",
    "        securite = consommation * (delai_livraison / 30)  # stock de sécurité en jours\n",
    "        stock_securite_mois = max(stock_securite, securite)\n",
    "        if stock < consommation + stock_securite_mois:\n",
    "            commande = consommation + stock_securite_mois - stock\n",
    "            total_cout += commande * cout_unitaire + cout_lancement\n",
    "            stock += commande\n",
    "        stock -= consommation\n",
    "    return total_cout\n",
    "\n",
    "# Budgétisation par quantités constantes\n",
    "def budgetisation_quantites_constantes(stock_initial, quantite_constante, previsions_consommation, cout_unitaire, cout_lancement):\n",
    "    total_cout = 0\n",
    "    stock = stock_initial\n",
    "    for consommation in previsions_consommation:\n",
    "        if stock < consommation:\n",
    "            total_cout += quantite_constante * cout_unitaire + cout_lancement\n",
    "            stock += quantite_constante\n",
    "        stock -= consommation\n",
    "    return total_cout\n",
    "\n",
    "# Données d'exemple pour la budgétisation\n",
    "previsions_consommation = [800, 1200, 1800, 2400, 1000, 800]  # prévisions de consommation sur 6 mois\n",
    "cout_unitaire = 40  # prix par unité\n",
    "cout_lancement = 1000  # coût de lancement d'une commande\n",
    "taux_possession = 0.10  # taux de possession en %\n",
    "stock_initial = 800  # stock initial\n",
    "delai_livraison = 15  # délai de livraison en jours\n",
    "stock_securite = 400  # stock de sécurité\n",
    "\n",
    "# Calcul des coûts avec pénurie\n",
    "q_optimal_penurie = calcul_lot_economique_penurie(consommation_annuelle, cout_stockage_unite_mois, cout_lancement_commande, cout_penurie)\n",
    "\n",
    "# Budgétisation par périodes constantes\n",
    "cout_budg_periodes = budgetisation_periodes_constantes(previsions_consommation, cout_unitaire, cout_lancement, taux_possession, stock_initial, delai_livraison, stock_securite)\n",
    "\n",
    "# Budgétisation par quantités constantes\n",
    "quantite_constante = 2000  # quantité constante de commande\n",
    "cout_budg_quantites = budgetisation_quantites_constantes(stock_initial, quantite_constante, previsions_consommation, cout_unitaire, cout_lancement)\n",
    "\n",
    "# Affichage des résultats\n",
    "#print(f\"Quantité optimale avec prise en compte de la pénurie (q*): {q_optimal_penurie:.2f} unités\")\n",
    "#print(f\"Coût total budgétisation par périodes constantes: {cout_budg_periodes:.2f} €\")\n",
    "#print(f\"Coût total budgétisation par quantités constantes: {cout_budg_quantites:.2f} €\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4985c833-6986-463e-9158-635de99910f2",
   "metadata": {},
   "source": [
    " \n",
    "\n",
    "### Explication du code :\n",
    "\n",
    "1. **Modèle déterministe avec prise en compte de la pénurie** : Nous avons modifié la formule de Wilson pour tenir compte du coût de pénurie et ainsi ajuster la quantité économique optimale de commande.\n",
    "\n",
    "2. **Budgétisation par périodes constantes** : Ce calcul simule des commandes régulières à des intervalles prédéfinis pour répondre aux prévisions de consommation, en tenant compte du stock de sécurité.\n",
    "\n",
    "3. **Budgétisation par quantités constantes** : Ce calcul simule des commandes de quantités fixes (2 000 unités dans cet exemple), avec des réapprovisionnements déclenchés dès que le stock devient insuffisant pour couvrir la consommation prévue.\n",
    "\n",
    "###  Affichage des résultats :\n",
    "\n",
    " \n",
    "**Quantité optimale avec prise en compte de la pénurie** (**q***): **6208.32 unités**  \n",
    "**Coût total budgétisation par périodes constantes: 36000.00 €**  \n",
    "**Coût total budgétisation par quantités constantes: 80000.00 €**  \n",
    " \n",
    "\n",
    "Ce script permet d'optimiser la gestion des stocks en intégrant les coûts de pénurie et en simulant différents types de budgétisation. Vous pouvez ajuster les données d'entrée pour correspondre aux besoins spécifiques de votre entreprise."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6c79ba52-2093-4b61-9d24-d00bf766313c",
   "metadata": {},
   "source": [
    "La résolution classique du budget d'approvisionnement suit généralement la méthode du **modèle de Wilson**, qui ne prend pas en compte les pénuries, mais se concentre sur l'optimisation des coûts de gestion des stocks en trouvant la quantité économique à commander (lot économique). Cette méthode repose sur un compromis entre les **coûts de possession** (ou coûts de stockage) et les **coûts de lancement** des commandes.\n",
    "\n",
    "### La formule classique de Wilson :\n",
    "\n",
    "$$\n",
    "q^* = \\sqrt{\\frac{2 \\times Q \\times C_L}{C_S}}\n",
    "$$\n",
    "Où :\n",
    "- \\( q^* \\) est la quantité économique à commander.\n",
    "- \\( Q \\) est la demande annuelle (consommation annuelle).\n",
    "- \\( C_L \\) est le coût de lancement d'une commande.\n",
    "- \\( C_S \\) est le coût de stockage unitaire annuel.\n",
    "\n",
    "### Étapes de la résolution classique\n",
    "\n",
    "1. **Calculer le lot économique à commander (\\( q^* \\))** en utilisant la formule de Wilson.\n",
    "2. **Calculer le nombre optimal de commandes (\\( N^* \\))** par an, en divisant la consommation annuelle par la quantité économique à commander :\n",
    "$$\n",
    "   N^* = \\frac{Q}{q^*}\n",
    "$$\n",
    "3. **Calculer les coûts de gestion des stocks** :\n",
    "   - **Coût de possession** : C'est le coût de stockage par unité multiplié par la moitié de la quantité économique à commander (puisque le stock moyen est \\( q^*/2 \\)).\n",
    "   - **Coût de lancement total** : Il s'agit du coût unitaire de lancement multiplié par le nombre de commandes.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "09d63996-78d5-40a5-b1b2-830675f1c069",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Quantité optimale à commander (q*): 5760.66 unités\n",
      "Nombre optimal de commandes par an: 55.55\n",
      "Coût de possession annuel: 31107.56 €\n",
      "Coût de lancement total annuel: 31107.56 €\n",
      "Coût total de gestion des stocks: 62215.11 €\n"
     ]
    }
   ],
   "source": [
    "\n",
    "### Code Python pour la résolution classique\n",
    " \n",
    "import math\n",
    "\n",
    "# Données d'exemple\n",
    "consommation_annuelle = 320000  # consommation annuelle en unités\n",
    "cout_stockage_unite_mois = 0.90  # coût de stockage par unité par mois en euros\n",
    "cout_lancement_commande = 560  # coût de lancement d'une commande en euros\n",
    "\n",
    "# Calcul du lot économique de commande (modèle classique de Wilson)\n",
    "def calcul_lot_economique_classique(consommation_annuelle, cout_stockage_unite_mois, cout_lancement_commande):\n",
    "    cout_stockage_unite_an = cout_stockage_unite_mois * 12  # Convertir le coût de stockage à l'année\n",
    "    q_optimal = math.sqrt((2 * consommation_annuelle * cout_lancement_commande) / cout_stockage_unite_an)\n",
    "    return q_optimal\n",
    "\n",
    "# Calcul du nombre optimal de commandes\n",
    "def calcul_nombre_commandes_optimum(consommation_annuelle, q_optimal):\n",
    "    nombre_commandes = consommation_annuelle / q_optimal\n",
    "    return nombre_commandes\n",
    "\n",
    "# Calcul du coût de possession\n",
    "def calcul_cout_possession(q_optimal, cout_stockage_unite_an):\n",
    "    cout_possession = (q_optimal / 2) * cout_stockage_unite_an\n",
    "    return cout_possession\n",
    "\n",
    "# Calcul du coût de lancement total\n",
    "def calcul_cout_lancement_total(nombre_commandes, cout_lancement_commande):\n",
    "    cout_lancement_total = nombre_commandes * cout_lancement_commande\n",
    "    return cout_lancement_total\n",
    "\n",
    "# Calcul du coût total de gestion des stocks\n",
    "def calcul_cout_total_gestion_stocks(cout_possession, cout_lancement_total):\n",
    "    cout_total = cout_possession + cout_lancement_total\n",
    "    return cout_total\n",
    "\n",
    "# Application des formules\n",
    "q_optimal = calcul_lot_economique_classique(consommation_annuelle, cout_stockage_unite_mois, cout_lancement_commande)\n",
    "nombre_commandes_optimum = calcul_nombre_commandes_optimum(consommation_annuelle, q_optimal)\n",
    "cout_stockage_unite_an = cout_stockage_unite_mois * 12  # Conversion du coût de stockage mensuel à l'année\n",
    "cout_possession = calcul_cout_possession(q_optimal, cout_stockage_unite_an)\n",
    "cout_lancement_total = calcul_cout_lancement_total(nombre_commandes_optimum, cout_lancement_commande)\n",
    "cout_total_gestion_stocks = calcul_cout_total_gestion_stocks(cout_possession, cout_lancement_total)\n",
    "\n",
    "# Affichage des résultats\n",
    "print(f\"Quantité optimale à commander (q*): {q_optimal:.2f} unités\")\n",
    "print(f\"Nombre optimal de commandes par an: {nombre_commandes_optimum:.2f}\")\n",
    "print(f\"Coût de possession annuel: {cout_possession:.2f} €\")\n",
    "print(f\"Coût de lancement total annuel: {cout_lancement_total:.2f} €\")\n",
    "print(f\"Coût total de gestion des stocks: {cout_total_gestion_stocks:.2f} €\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "491a4f4a-3d7c-42ce-94d1-faea70b9ecb3",
   "metadata": {},
   "source": [
    "### Conclusion\n",
    "\n",
    "La résolution classique de Wilson permet d'optimiser les coûts de gestion des stocks en trouvant la quantité optimale à commander. Cette méthode est utile pour les entreprises qui cherchent à minimiser leurs coûts de gestion des stocks sans prendre en compte les pénuries. Si des pénuries sont présentes, il est recommandé d'utiliser une version modifiée de la formule de Wilson, comme nous l'avons vu précédemment avec la prise en compte des pénuries. "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f7e8d40a-67ff-413d-a6be-f8a0b47c3d2b",
   "metadata": {},
   "source": [
    "Pour la résolution du budget d'approvisionnement en utilisant la méthode classique de Wilson dans Excel, nous allons créer des formules qui permettent de calculer le lot économique de commande, le nombre optimal de commandes, et les coûts associés. Voici comment vous pouvez structurer cela sous Excel.\n",
    "\n",
    "### Étapes de mise en place dans Excel\n",
    "\n",
    "1. **Les données initiales** : Créez un tableau pour saisir les données principales de votre entreprise, telles que la consommation annuelle, le coût de lancement de commande, et le coût de stockage par unité.\n",
    "\n",
    "2. **Formules pour le modèle de Wilson** : Utilisez des formules Excel pour calculer le lot économique de commande, le nombre de commandes par an, le coût de possession, et le coût de lancement.\n",
    "\n",
    "### Exemple de tableau Excel\n",
    "\n",
    "Voici les colonnes et formules à utiliser dans Excel pour mettre en œuvre le modèle de Wilson :\n",
    "\n",
    "| **Paramètres**                  | **Valeur**                |\n",
    "|---------------------------------|---------------------------|\n",
    "| Consommation annuelle (Q)       | 320000                    |\n",
    "| Coût de lancement (C_L)         | 560                       |\n",
    "| Coût de stockage par unité par mois (C_S) | 0,90                      |\n",
    "\n",
    "| **Calculs**                     | **Formule**               | **Résultat**                |\n",
    "|---------------------------------|---------------------------|-----------------------------|\n",
    "| Coût de stockage annuel par unité | `=C_S*12`                | (Automatique)               |\n",
    "| Lot économique de commande (q*) | `=SQRT((2*Q*C_L)/C_S_An)` | Quantité optimale (q*)      |\n",
    "| Nombre optimal de commandes (N) | `=Q/q*`                   | Nombre de commandes         |\n",
    "| Coût de possession total        | `=C_S_An*(q*/2)`          | Coût de possession          |\n",
    "| Coût de lancement total         | `=C_L*N`                  | Coût de lancement           |\n",
    "| Coût total de gestion des stocks | `=Coût de possession total + Coût de lancement total` | Coût total |\n",
    "\n",
    "### Explication des formules Excel :\n",
    "\n",
    "1. **Coût de stockage annuel par unité** :\n",
    "   - La formule pour convertir le coût de stockage mensuel en coût annuel est :  \n",
    "     `=C3*12` (si la cellule du coût mensuel est `C3`).\n",
    "\n",
    "2. **Lot économique de commande (q*)** :\n",
    "   - Utilisez la formule de Wilson :  \n",
    "     `=SQRT((2*C2*C4)/C6)`  \n",
    "     Où `C2` est la consommation annuelle, `C4` est le coût de lancement de la commande, et `C6` est le coût de stockage annuel.\n",
    "\n",
    "3. **Nombre optimal de commandes (N)** :\n",
    "   - Calculé en divisant la consommation annuelle par la quantité optimale :  \n",
    "     `=C2/D8`  \n",
    "     Où `C2` est la consommation annuelle et `D8` est le lot économique de commande.\n",
    "\n",
    "4. **Coût de possession total** :\n",
    "   - Le coût de possession est calculé sur la base du stock moyen :  \n",
    "     `=C6*(D8/2)`  \n",
    "     Où `C6` est le coût de stockage annuel et `D8` est le lot économique de commande.\n",
    "\n",
    "5. **Coût de lancement total** :\n",
    "   - Multiplication du coût de lancement par le nombre de commandes :  \n",
    "     `=C4*D10`  \n",
    "     Où `C4` est le coût de lancement et `D10` est le nombre optimal de commandes.\n",
    "\n",
    "6. **Coût total de gestion des stocks** :\n",
    "   - Addition du coût de possession et du coût de lancement :  \n",
    "     `=D12+D13`  \n",
    "     Où `D12` est le coût de possession et `D13` est le coût de lancement.\n",
    "\n",
    "### Exemple Visuel sous Excel :\n",
    "\n",
    "| **A**                           | **B**                     | **C**               |\n",
    "|---------------------------------|---------------------------|---------------------|\n",
    "| **Paramètres**                  | **Valeur**                |                     |\n",
    "| Consommation annuelle (Q)       | 320000                    |                     |\n",
    "| Coût de lancement (C_L)         | 560                       |                     |\n",
    "| Coût de stockage par unité par mois (C_S) | 0,90                      |                     |\n",
    "| **Calculs**                     |                           | **Résultat**        |\n",
    "| Coût de stockage annuel par unité | `=C3*12`                | (exemple : 10,8 €)  |\n",
    "| Lot économique de commande (q*) | `=SQRT((2*B2*B3)/C4)`    | (exemple : 5761 unités) |\n",
    "| Nombre optimal de commandes (N) | `=B2/D5`                 | (exemple : 55,54 commandes) |\n",
    "| Coût de possession total        | `=C4*(D5/2)`             | (exemple : 31 109 €) |\n",
    "| Coût de lancement total         | `=B3*D6`                 | (exemple : 31 102 €) |\n",
    "| Coût total de gestion des stocks | `=D7+D8`                | (exemple : 62 211 €) |\n",
    "\n",
    "### Conclusion\n",
    "\n",
    "Avec ce tableau et ces formules, vous pouvez facilement calculer le budget d'approvisionnement en utilisant le modèle classique de Wilson sous Excel. Vous pouvez aussi ajuster les paramètres (consommation, coûts de lancement, coûts de stockage) en fonction des spécificités de votre entreprise pour voir comment ces changements affectent vos coûts globaux de gestion des stocks."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b1cc6f34-2179-4f98-a3c4-abb7ab8b67aa",
   "metadata": {},
   "source": [
    "---\n",
    "# Le Budget d'Investissement théorie et applications \n",
    "\n",
    "Le budget d'investissement est une projection à long terme des dépenses d'une entreprise pour des projets qui visent à développer ou à améliorer ses actifs (installations, équipements, technologie, etc.). Les choix d'investissements faits aujourd'hui conditionnent l'évolution future de l'entreprise et influencent sa rentabilité à long terme."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f3e8f47c-d52f-4cb5-96cd-57efae9408f6",
   "metadata": {},
   "source": [
    " \n",
    "### Qu'est-ce que le budget d'investissement ?\n",
    "\n",
    "Le **budget d'investissement** est un plan financier qui répertorie les grandes dépenses que l'entreprise prévoit de réaliser dans le futur pour des projets à long terme, comme l'achat de nouveaux équipements, la construction d'installations, ou le développement de technologies. Ces investissements sont essentiels pour soutenir la croissance de l'entreprise, améliorer la productivité ou même réduire les coûts à long terme.\n",
    "\n",
    "### Pourquoi est-ce important ?\n",
    "\n",
    "Les décisions d'investissement que prend une entreprise aujourd'hui auront des répercussions sur sa santé financière et ses performances à long terme. Par exemple, investir dans une nouvelle machine peut permettre à une entreprise d'augmenter sa production et ses bénéfices futurs. Mais si cet investissement n’est pas bien pensé, il peut entraîner des pertes importantes.\n",
    "\n",
    "### Les étapes du processus d'investissement\n",
    "\n",
    "1. **Sélection des investissements** :\n",
    "   Cette première étape consiste à choisir les projets sur lesquels l'entreprise va investir. Les projets sont évalués selon différents critères :\n",
    "   - **Critères commerciaux** : Est-ce que l'investissement va augmenter les ventes ou améliorer la qualité des produits ?\n",
    "   - **Critères techniques** : La technologie ou l'infrastructure est-elle adaptée et durable ?\n",
    "   - **Critères financiers** : L'investissement est-il rentable ?\n",
    "   - **Critères légaux** : L'investissement respecte-t-il les lois et réglementations ?\n",
    "\n",
    "   Exemple : Une entreprise souhaite acheter de nouvelles machines pour produire plus rapidement. Elle doit comparer plusieurs options de machines, en tenant compte du coût d'achat, des coûts d'entretien, et des bénéfices potentiels.\n",
    "\n",
    "2. **Contrôle des investissements** :\n",
    "   Une fois que l'investissement est approuvé, il est important de suivre son exécution. Cela signifie s'assurer que les dépenses réelles correspondent au budget prévu et que les délais sont respectés. Cela permet de détecter tout dépassement de budget ou retard qui pourrait impacter l'entreprise.\n",
    "\n",
    "   Exemple : Après avoir acheté les machines, l'entreprise doit surveiller si les coûts d'installation sont conformes au budget et si les machines sont installées à temps pour ne pas retarder la production.\n",
    "\n",
    "### Les Méthodes de Choix des Investissements\n",
    "\n",
    "Il existe plusieurs façons d'évaluer les investissements. Voici les principales méthodes utilisées.\n",
    "\n",
    "#### 1. **Méthodes sans actualisation**\n",
    "\n",
    "Ces méthodes ne tiennent pas compte du fait que l’argent a une valeur différente selon le moment où il est reçu (par exemple, un euro aujourd'hui vaut plus qu'un euro reçu dans cinq ans).\n",
    "\n",
    "- **Le délai de récupération du capital investi** :\n",
    "  Cette méthode mesure combien de temps il faudra pour récupérer le montant investi à travers les bénéfices générés par l'investissement. Le projet qui récupère son capital le plus rapidement est préféré.\n",
    "\n",
    "  **Exemple** :  \n",
    "  Imaginons deux projets :\n",
    "  - **Projet A** : Récupère son investissement en 3 ans.\n",
    "  - **Projet B** : Récupère son investissement en 5 ans.\n",
    "\n",
    "  On choisira le projet A, car il permet de récupérer l’argent plus rapidement.\n",
    "\n",
    "- **Le taux de rentabilité comptable** :\n",
    "  Cette méthode calcule le rendement de l'investissement, c’est-à-dire combien chaque euro investi rapporte en bénéfices. L'investissement avec le taux de rentabilité le plus élevé est choisi.\n",
    "\n",
    "  **Exemple** :  \n",
    "  Si un investissement de 100 000 € génère 10 000 € de bénéfices chaque année, le taux de rentabilité est de 10 % par an.\n",
    "\n",
    "#### 2. **Méthodes avec actualisation**\n",
    "\n",
    "Ces méthodes prennent en compte la valeur temporelle de l'argent. En d'autres termes, elles tiennent compte du fait que l'argent que l'on gagne aujourd'hui vaut plus que celui que l'on gagnera demain.\n",
    "\n",
    "- **La Valeur Actuelle Nette (VAN)** :\n",
    "  La VAN compare la somme des revenus futurs (actualisés) à la dépense initiale. Si la VAN est positive, cela signifie que l'investissement est rentable.\n",
    "\n",
    "  **Exemple** :\n",
    "  - Un projet coûte 150 000 € aujourd'hui.\n",
    "  - Il génère des flux de trésorerie (recettes nettes) de 50 000 €, 45 000 €, 40 000 €, 35 000 €, et 30 000 € au cours des cinq prochaines années.\n",
    "\n",
    "  Pour calculer la VAN, on actualise ces flux futurs en fonction d'un taux d'actualisation (par exemple 15 %) et on les compare à la dépense initiale.\n",
    "\n",
    "  Si la VAN est positive (par exemple, 17 607 €), l'investissement est jugé bon. Si la VAN est négative, l'investissement est à éviter.\n",
    "\n",
    "### La Budgétisation des Investissements\n",
    "\n",
    "La budgétisation des investissements est le processus de planification des engagements financiers pour des projets d'investissement futurs. Elle permet à l'entreprise de prévoir les flux de trésorerie nécessaires et de s'assurer que les projets se déroulent comme prévu.\n",
    "\n",
    "#### Les 3 étapes du processus de budgétisation des investissements :\n",
    "\n",
    "1. **Temps 1 - Dates d'engagement** :\n",
    "   Ce sont les moments où l'entreprise prend une décision ferme de réaliser un investissement. Une fois cette date passée, il n'est plus possible de revenir sur la décision sans encourir des frais d'annulation.\n",
    "\n",
    "   **Exemple** : L'entreprise décide d'acheter une nouvelle usine. Après la signature du contrat, elle ne peut plus annuler l'achat sans pénalités.\n",
    "\n",
    "2. **Temps 2 - Dates de décaissement** :\n",
    "   Ce sont les dates auxquelles l'entreprise doit payer pour les travaux ou les actifs. Il est crucial de vérifier que les montants facturés correspondent à ce qui avait été budgété.\n",
    "\n",
    "   **Exemple** : L'entreprise paie progressivement les travaux de construction de la nouvelle usine en vérifiant que les factures sont conformes au budget.\n",
    "\n",
    "3. **Temps 3 - Dates de réception** :\n",
    "   Ce sont les dates où l'entreprise reçoit les actifs ou termine les travaux. Cela permet de commencer à utiliser l'investissement pour générer des revenus.\n",
    "\n",
    "   **Exemple** : L'usine est prête à être utilisée et la production peut commencer, ce qui permet à l'entreprise de réaliser des bénéfices grâce à cet investissement.\n",
    "\n",
    "Voici une liste complète des formules essentielles liées au **budget d'investissement**, avec des explications détaillées de chaque formule et leur utilisation.\n",
    "\n",
    "\n",
    "\n",
    "### 1. **Le délai de récupération du capital investi**\n",
    "\n",
    "Le délai de récupération mesure combien de temps il faudra pour que les flux de trésorerie générés par l'investissement compensent l'investissement initial.\n",
    "\n",
    "#### Formule :\n",
    "$$\n",
    "\\text{Délai de récupération} = \\frac{\\text{Investissement initial}}{\\text{Flux de trésorerie annuel moyen}}\n",
    "$$\n",
    "\n",
    "#### Explication :\n",
    "- Cette formule est utilisée pour déterminer combien d'années il faudra pour récupérer l'investissement initial à travers les revenus générés par cet investissement.\n",
    "- **Exemple** : Si vous investissez 100 000 € et que l'investissement génère 20 000 € de flux de trésorerie chaque année, le délai de récupération sera :\n",
    "$$\n",
    "  \\frac{100\\,000}{20\\,000} = 5 \\text{ ans}\n",
    "$$\n",
    "- **Application** : L'investissement avec le délai de récupération le plus court est généralement préféré, car il récupère le capital plus rapidement.\n",
    "\n",
    "### 2. **Taux de rentabilité comptable**\n",
    "\n",
    "Le taux de rentabilité comptable est une mesure du rendement de l'investissement. Il compare le bénéfice moyen généré par l'investissement au capital investi.\n",
    "\n",
    "#### Formule :\n",
    "$$\n",
    "T = \\frac{\\text{Bénéfice moyen annuel}}{\\text{Capital investi}}\n",
    "$$\n",
    "\n",
    "#### Explication :\n",
    "- Cette formule mesure combien l'investissement rapporte chaque année par rapport à l'investissement initial.\n",
    "- **Exemple** : Si un investissement de 100 000 € génère un bénéfice moyen annuel de 10 000 €, le taux de rentabilité comptable sera :\n",
    "$$\n",
    "  T = \\frac{10\\,000}{100\\,000} = 10\\%\n",
    "$$\n",
    "- **Application** : Un taux de rentabilité plus élevé indique un investissement plus rentable.\n",
    "\n",
    "### 3. **Valeur Actuelle Nette (VAN)**\n",
    "\n",
    "La Valeur Actuelle Nette (VAN) est une mesure clé dans les décisions d'investissement, qui prend en compte la valeur temporelle de l'argent. Elle actualise les flux de trésorerie futurs pour les comparer à la dépense initiale de l'investissement.\n",
    "\n",
    "#### Formule :\n",
    "$$\n",
    "\\text{VAN} = \\sum_{t=1}^{n} \\frac{\\text{CF}_t}{(1 + r)^t} - I_0\n",
    "$$\n",
    "\n",
    "Où :\n",
    "- $( \\text{CF}_t )$ est le flux de trésorerie de l'année \\( t \\),\n",
    "- \\( r \\) est le taux d'actualisation (ou le coût du capital),\n",
    "- \\( t \\) est l'année (1, 2, ..., n),\n",
    "- \\( I_0 \\) est l'investissement initial.\n",
    "\n",
    "#### Explication :\n",
    "- La VAN actualise les flux de trésorerie futurs pour tenir compte du fait que l'argent aujourd'hui vaut plus que le même montant dans le futur (en raison des intérêts potentiels ou de l'inflation).\n",
    "- **Exemple** : Si un investissement initial de 150 000 € génère des flux de trésorerie sur 5 ans de 50 000 €, 45 000 €, 40 000 €, 35 000 €, et 30 000 €, et que le taux d'actualisation est de 15 %, la VAN est :\n",
    "$$\n",
    "  \\text{VAN} = \\frac{50\\,000}{(1+0,15)^1} + \\frac{45\\,000}{(1+0,15)^2} + \\cdots - 150\\,000\n",
    "$$\n",
    "  Supposons que cela donne une VAN de 17 607 €.\n",
    "- **Application** : Si la VAN est positive, l'investissement est rentable ; s'il est négatif, l'investissement n'est pas recommandé.\n",
    "\n",
    "### 4. **Flux de Trésorerie Actualisé (FTA)**\n",
    "\n",
    "Pour calculer la VAN, il faut d'abord actualiser chaque flux de trésorerie futur. Le flux de trésorerie actualisé est le flux de trésorerie futur ramené à sa valeur actuelle en utilisant le taux d'actualisation.\n",
    "\n",
    "#### Formule :\n",
    "$$\n",
    "\\text{FTA}_t = \\frac{\\text{CF}_t}{(1 + r)^t}\n",
    "$$\n",
    "\n",
    "#### Explication :\n",
    "- **CF** est le flux de trésorerie attendu à l'année \\( t \\).\n",
    "- **r** est le taux d'actualisation.\n",
    "- **t** est l'année du flux de trésorerie.\n",
    "- **Exemple** : Si un flux de trésorerie de 50 000 € est attendu dans un an, et que le taux d'actualisation est de 15 %, le flux de trésorerie actualisé sera :\n",
    "$$\n",
    "  \\text{FTA}_1 = \\frac{50\\,000}{(1 + 0,15)^1} = 43\\,478 \\, \\text{€}\n",
    "$$\n",
    "- **Application** : Ce concept est utilisé pour ramener tous les flux de trésorerie futurs à une base commune (valeur actuelle), afin de les comparer avec la dépense initiale.\n",
    "\n",
    "### 5. **Taux Interne de Rentabilité (TIR)**\n",
    "\n",
    "Le Taux Interne de Rentabilité (TIR) est le taux d'actualisation qui rend la VAN égale à zéro. Il représente le rendement que l'on peut attendre de l'investissement.\n",
    "\n",
    "#### Formule :\n",
    "$$\n",
    "\\sum_{t=1}^{n} \\frac{\\text{CF}_t}{(1 + \\text{TIR})^t} - I_0 = 0\n",
    "$$\n",
    "\n",
    "#### Explication :\n",
    "- Le TIR est calculé de manière itérative (souvent à l'aide d'outils informatiques comme Excel).\n",
    "- **Application** : Si le TIR est supérieur au coût du capital (ou au taux d'actualisation), l'investissement est considéré comme rentable.\n",
    "\n",
    "### 6. **Indice de Profitabilité (IP)**\n",
    "\n",
    "L'indice de profitabilité mesure la rentabilité d'un projet par unité monétaire investie. Il est calculé en divisant la valeur actuelle des flux de trésorerie futurs par l'investissement initial.\n",
    "\n",
    "#### Formule :\n",
    "$$\n",
    "IP = \\frac{\\sum_{t=1}^{n} \\frac{\\text{CF}_t}{(1 + r)^t}}{I_0}\n",
    "$$\n",
    "\n",
    "#### Explication :\n",
    "- **Exemple** : Si les flux de trésorerie actualisés d'un projet sont de 180 000 € et que l'investissement initial est de 150 000 €, l'indice de profitabilité est :\n",
    "$$\n",
    "  IP = \\frac{180\\,000}{150\\,000} = 1,2\n",
    "$$\n",
    "- **Application** : Si l'indice de profitabilité est supérieur à 1, l'investissement est considéré comme rentable.\n",
    "\n",
    "### 7. **Dépenses Initiales et Engagements Financiers**\n",
    "\n",
    "Lorsque l'on planifie un investissement, il est crucial de comprendre les engagements financiers à différentes étapes du projet.\n",
    "\n",
    "- **Dépenses Initiales** : Ce sont les fonds nécessaires pour commencer un projet. Cela inclut l'achat de matériel, la construction, etc.\n",
    "- **Dates de Décaissement** : Ce sont les dates auxquelles les paiements doivent être effectués.\n",
    "- **Dates de Réception** : Ce sont les dates où les actifs ou les projets sont achevés et livrés, permettant de démarrer les activités génératrices de revenus.\n",
    "\n",
    "### Exemple d'Application en Excel\n",
    "\n",
    "Pour appliquer toutes ces formules dans Excel, vous pouvez utiliser les fonctions suivantes :\n",
    "\n",
    "1. **VAN** : Utilisez la fonction `VAN()` pour calculer la VAN des flux de trésorerie.\n",
    "   - Exemple : `=VAN(15%, B2:B6) - 150000`\n",
    "   - Cette formule calcule la VAN pour des flux de trésorerie dans les cellules B2 à B6 avec un taux d'actualisation de 15 % et une dépense initiale de 150 000 €.\n",
    "\n",
    "2. **TIR** : Utilisez la fonction `TIR()` pour trouver le taux interne de rentabilité.\n",
    "   - Exemple : `=TIR(B2:B6)`\n",
    "   - Cette formule calcule le taux interne de rentabilité pour les flux de trésorerie dans les cellules B2 à B6.\n",
    "\n",
    "3. **Indice de Profitabilité (IP)** : Utilisez `VAN()` pour calculer les flux actualisés et divisez par l'investissement initial.\n",
    "   - Exemple : `=VAN(15%, B2:B6)/150000`\n",
    "\n",
    "### Conclusion\n",
    "\n",
    "Ces formules sont essentielles pour évaluer la viabilité des projets d'investissement. Elles vous permettent de comparer plusieurs options et de prendre des décisions éclairées basées sur la rentabilité financière à long terme. L'utilisation de ces méthodes assure une gestion stratégique et rentable des investissements au sein d'une entreprise.\n",
    "\n",
    " \n",
    "\n",
    "Le **budget d'investissement** est crucial pour la planification à long terme des entreprises. Il permet de s'assurer que les fonds sont utilisés de manière efficace pour des projets qui amélioreront les performances futures de l'entreprise. En utilisant des méthodes d'évaluation rigoureuses (comme la VAN ou le délai de récupération), les entreprises peuvent sélectionner les investissements les plus prometteurs. Ensuite, grâce à une budgétisation rigoureuse, elles peuvent suivre et contrôler les dépenses pour éviter les dépassements de coûts et s'assurer que les investissements génèrent les bénéfices attendus."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b0be1eb8-da4f-4d78-b432-933aac4615ad",
   "metadata": {},
   "source": [
    " \n",
    "### Exemple 1 : Choix d'investissement basé sur le délai de récupération\n",
    "\n",
    "Deux projets d'investissement sont proposés, A et B, avec les détails suivants :\n",
    "\n",
    "- **Investissement A** :\n",
    "  - Dépense initiale : 150 000 €\n",
    "  - Flux de trésorerie annuels (sur 5 ans) : 50 000 €, 45 000 €, 40 000 €, 35 000 €, 30 000 €\n",
    "  - Taux d'actualisation : 15 %\n",
    "\n",
    "- **Investissement B** :\n",
    "  - Dépense initiale : 150 000 €\n",
    "  - Flux de trésorerie annuels (sur 5 ans) : 80 000 €, 70 000 €, 60 000 €, 20 000 €, 20 000 €\n",
    "  - Taux d'actualisation : 15 %\n",
    "\n",
    "#### Délai de récupération (méthode sans actualisation)\n",
    "\n",
    "Le délai de récupération mesure le temps nécessaire pour récupérer l'investissement initial avec les flux de trésorerie générés chaque année.\n",
    "\n",
    "1. **Calcul pour l'investissement A** :\n",
    "   - Première année : 50 000 €\n",
    "   - Deuxième année : 50 000 € + 45 000 € = 95 000 €\n",
    "   - Troisième année : 95 000 € + 40 000 € = 135 000 €\n",
    "   - Quatrième année : 135 000 € + 35 000 € = 170 000 €\n",
    "\n",
    "   **Délai de récupération pour A** : Entre 3 et 4 ans, car l'investissement initial de 150 000 € est récupéré au début de la quatrième année.\n",
    "\n",
    "2. **Calcul pour l'investissement B** :\n",
    "   - Première année : 80 000 €\n",
    "   - Deuxième année : 80 000 € + 70 000 € = 150 000 €\n",
    "\n",
    "   **Délai de récupération pour B** : 2 ans, car l'investissement initial est récupéré à la fin de la deuxième année.\n",
    "\n",
    "#### Conclusion : On choisit l'investissement B car il a un délai de récupération plus court (2 ans contre environ 4 ans pour A).\n",
    "\n",
    "### Exemple 2 : Taux de rentabilité comptable\n",
    "\n",
    "Le taux de rentabilité comptable mesure le rendement moyen sur le capital investi.\n",
    "\n",
    "- **Formule** :  \n",
    "$$\n",
    "  T = \\frac{\\text{Bénéfice moyen annuel}}{\\text{Capital investi}}\n",
    "$$\n",
    "\n",
    "1. **Investissement A** :\n",
    "   - Bénéfice moyen : (50 000 € + 45 000 € + 40 000 € + 35 000 € + 30 000 €) / 5 = 40 000 €\n",
    "   - Taux de rentabilité :  \n",
    "  $$\n",
    "     T = \\frac{40\\,000}{150\\,000} = 26,67\\%\n",
    "$$\n",
    "\n",
    "2. **Investissement B** :\n",
    "   - Bénéfice moyen : (80 000 € + 70 000 € + 60 000 € + 20 000 € + 20 000 €) / 5 = 50 000 €\n",
    "   - Taux de rentabilité :  \n",
    " $$\n",
    "     T = \\frac{50\\,000}{150\\,000} = 33,33\\%\n",
    "  $$\n",
    "\n",
    "#### Conclusion : On choisit l'investissement B, car son taux de rentabilité comptable est plus élevé (33,33 % contre 26,67 % pour A).\n",
    "\n",
    "### Exemple 3 : Valeur actuelle nette (VAN)\n",
    "\n",
    "La VAN permet de calculer la rentabilité d'un investissement en actualisant les flux de trésorerie futurs à un taux d'actualisation donné et en les comparant à la dépense initiale.\n",
    "\n",
    "- **Formule** :  \n",
    "$$\n",
    "  \\text{VAN} = \\sum_{t=1}^{n} \\frac{\\text{CF}_t}{(1 + r)^t} - I_0\n",
    "$$\n",
    "\n",
    "Où :\n",
    "- $( \\text{CF}_t $) est le flux de trésorerie à l'année \\( t \\),\n",
    "- \\( r \\) est le taux d'actualisation (ici 15 %),\n",
    "- \\( I_0 \\) est la dépense initiale.\n",
    "\n",
    "1. **Investissement A** :\n",
    "   - CF actualisé pour la première année :  \n",
    "$$\n",
    "     \\frac{50\\,000}{(1 + 0,15)^1} = 43\\,478\n",
    "    $$\n",
    "   - CF actualisé pour la deuxième année :  \n",
    "$$\n",
    "     \\frac{45\\,000}{(1 + 0,15)^2} = 37\\,807\n",
    "   $$\n",
    "   - Et ainsi de suite pour 5 ans.\n",
    "\n",
    "   **Total des flux de trésorerie actualisés** : 167 607 €\n",
    "\n",
    "   **VAN pour A** :  \n",
    "$$\n",
    "   \\text{VAN} = 167\\,607 - 150\\,000 = 17\\,607 \\, \\text{€\n",
    "   }\n",
    "$$\n",
    "\n",
    "2. **Investissement B** :\n",
    "   - CF actualisé pour la première année :  \n",
    " $$\n",
    "     \\frac{80\\,000}{(1 + 0,15)^1} = 69\\,565\n",
    " $$\n",
    "   - Et ainsi de suite pour 5 ans.\n",
    "\n",
    "*VAN pour B* : 33 324 \n",
    "$$\n",
    "  \\text{VAN} = 33 324 \\text{€\n",
    "   }$$\n",
    "#### Conclusion : On choisit l'investissement B, car sa VAN est plus élevée (33 324 € contre 17 607 € pour A).\n",
    "\n",
    "### Conclusion générale\n",
    "\n",
    "En analysant les différents projets d'investissement avec les méthodes classiques de la finance d'entreprise, nous pouvons conclure que l'investissement B est supérieur à l'investissement A selon toutes les méthodes :\n",
    "- **Délai de récupération** : B récupère l'investissement en 2 ans contre environ 4 ans pour A.\n",
    "- **Taux de rentabilité comptable** : B est plus rentable (33,33 % contre 26,67 % pour A).\n",
    "- **VAN** : B a une VAN plus élevée (33 324 € contre 17 607 € pour A).\n",
    "\n",
    "Ainsi, l'investissement B est le choix préféré selon ces critères financiers."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fd15e14b-cf37-42ca-8730-e283b67cfb38",
   "metadata": {},
   "source": [
    "---\n",
    "# Budget de trésorerie  \n",
    "\n",
    "### Étapes de calcul du budget de trésorerie\n",
    "\n",
    "Le **budget de trésorerie** est un tableau prévisionnel qui permet de prévoir les encaissements (entrées d'argent) et les décaissements (sorties d'argent) mois par mois. Cela aide à anticiper les besoins de financement ou à identifier les excédents de trésorerie. Voici les étapes nécessaires :\n",
    "\n",
    "### 1. Collecte des informations principales\n",
    "\n",
    "#### Informations de base :\n",
    "- **Solde initial des liquidités** au 31 décembre N : 700 000 €\n",
    "- **Créances clients** au 31 décembre N : 1 320 000 € (80 % encaissées en janvier, le reste en février)\n",
    "- **Dettes fournisseurs** au 31 décembre N : 830 000 € (85 % réglées en janvier, le reste en février)\n",
    "  \n",
    "#### Prévisions des ventes et des achats (HT) pour les premiers mois de l'année N :\n",
    "- Janvier : Ventes = 650 000 €, Achats = 380 000 €\n",
    "- Février : Ventes = 780 000 €, Achats = 420 000 €\n",
    "- Mars : Ventes = 913 000 €, Achats = 478 000 €\n",
    "  \n",
    "#### Autres données importantes :\n",
    "- **Salaires et charges sociales** : 150 000 € par mois (non soumis à la TVA, réglés le mois même).\n",
    "- **Autres charges monétaires** : 70 000 € par mois (soumises à la TVA de 20 %, réglées au comptant).\n",
    "- **Renouvellement du parc de machines** pour un montant de 1 500 000 € HT (paiement échelonné : 30 % en janvier, 30 % en mars, 40 % en juillet).\n",
    "  \n",
    "### 2. Calcul des encaissements\n",
    "\n",
    "- **Créances clients de l'année précédente** :  \n",
    "  - Janvier : 80 % de 1 320 000 € = 1 056 000 €  \n",
    "  - Février : 20 % de 1 320 000 € = 264 000 €\n",
    "\n",
    "- **Encaissements sur les ventes** (basé sur le mode de règlement des clients) :  \n",
    "  - 50 % encaissés le mois de la vente  \n",
    "  - 30 % encaissés le mois suivant  \n",
    "  - 20 % encaissés deux mois après la vente\n",
    "\n",
    "#### Calculs des encaissements :\n",
    "- **Janvier** :\n",
    "  - Ventes de janvier : 50 % de 650 000 € = 325 000 €\n",
    "  - Créances clients : 1 056 000 €\n",
    "  - **Total encaissements janvier** = 1 381 000 €\n",
    "  \n",
    "- **Février** :\n",
    "  - Ventes de février : 50 % de 780 000 € = 390 000 €\n",
    "  - Solde des créances de décembre : 264 000 €\n",
    "  - Encaissement des 30 % des ventes de janvier : 30 % de 650 000 € = 195 000 €\n",
    "  - **Total encaissements février** = 849 000 €\n",
    "  \n",
    "- **Mars** :\n",
    "  - Ventes de mars : 50 % de 913 000 € = 456 500 €\n",
    "  - Encaissement des 30 % des ventes de février : 30 % de 780 000 € = 234 000 €\n",
    "  - Encaissement des 20 % des ventes de janvier : 20 % de 650 000 € = 130 000 €\n",
    "  - **Total encaissements mars** = 820 500 €\n",
    "\n",
    "### 3. Calcul des décaissements\n",
    "\n",
    "- **Dettes fournisseurs de l'année précédente** :  \n",
    "  - Janvier : 85 % de 830 000 € = 705 500 €  \n",
    "  - Février : 15 % de 830 000 € = 124 500 €\n",
    "\n",
    "- **Règlements sur les achats** (basé sur le mode de règlement des fournisseurs) :  \n",
    "  - 30 % payés le mois de l'achat  \n",
    "  - 60 % payés le mois suivant  \n",
    "  - 10 % payés deux mois après l'achat\n",
    "\n",
    "#### Calculs des décaissements :\n",
    "- **Janvier** :\n",
    "  - Achats de janvier : 30 % de 380 000 € = 114 000 €\n",
    "  - Dettes fournisseurs de décembre : 705 500 €\n",
    "  - Salaires et charges sociales : 150 000 €\n",
    "  - Autres charges monétaires : 70 000 € + TVA 20 % = 84 000 €\n",
    "  - Premier paiement pour les machines : 30 % de 1 500 000 € = 450 000 €\n",
    "  - **Total décaissements janvier** = 1 503 500 €\n",
    "  \n",
    "- **Février** :\n",
    "  - Achats de février : 30 % de 420 000 € = 126 000 €\n",
    "  - Solde des dettes fournisseurs de décembre : 124 500 €\n",
    "  - Règlement des 60 % des achats de janvier : 60 % de 380 000 € = 228 000 €\n",
    "  - Salaires et charges sociales : 150 000 €\n",
    "  - Autres charges monétaires : 84 000 €\n",
    "  - **Total décaissements février** = 712 500 €\n",
    "  \n",
    "- **Mars** :\n",
    "  - Achats de mars : 30 % de 478 000 € = 143 400 €\n",
    "  - Règlement des 60 % des achats de février : 60 % de 420 000 € = 252 000 €\n",
    "  - Règlement des 10 % des achats de janvier : 10 % de 380 000 € = 38 000 €\n",
    "  - Salaires et charges sociales : 150 000 €\n",
    "  - Autres charges monétaires : 84 000 €\n",
    "  - Deuxième paiement pour les machines : 30 % de 1 500 000 € = 450 000 €\n",
    "  - **Total décaissements mars** = 1 117 400 €\n",
    "\n",
    "### 4. Établissement du solde de trésorerie\n",
    "\n",
    "- **Solde initial** : 700 000 €\n",
    "- Calcul du solde de trésorerie pour chaque mois en soustrayant les décaissements des encaissements.\n",
    "\n",
    "#### Solde mensuel :\n",
    "- **Janvier** :\n",
    "\n",
    "  $\\text{Solde janvier}$ = 700\\,000 + 1\\,381\\,000 - 1\\,503\\,500 = 577\\,500\\,$\\text€$\n",
    "\n",
    "- **Février** :\n",
    "\n",
    "  $\\text{Solde février}$ = 577\\,500 + 849\\,000 - 712\\,500 = 714\\,000\\,$\\text€$\n",
    "\n",
    "- **Mars** :\n",
    " \n",
    "  $\\text{Solde mars}$ = 714\\,000 + 820\\,500 - 1\\,117\\,400 = 417\\,100\\,$\\text€$\n",
    "  \n",
    "### Conclusion\n",
    "\n",
    "Le **budget de trésorerie** vous permet de prévoir les flux d'argent mois par mois, et d'ajuster vos décisions en fonction des soldes de trésorerie. Ces prévisions sont essentielles pour anticiper les besoins de financement ou pour identifier les excédents que l'entreprise peut réinvestir ou distribuer."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7dbc4eae-ab5c-47cd-81d1-a8fc3802003a",
   "metadata": {},
   "source": [
    "---\n",
    "### Concepts Clés et Méthodologie pour la Conception du Budget\n",
    "---\n",
    "Le **budget** est un outil essentiel de gestion pour planifier et coordonner les ressources financières d'une entreprise. Il implique la prévision des recettes et des dépenses sur une période donnée. Voici les concepts clés et la méthodologie adaptée pour concevoir un budget global efficace, incluant le budget de trésorerie.\n",
    "\n",
    "- une vue d'ensemble de la démarche budgétaire , un code Python pour modéliser ces étapes.\n",
    "- Ce processus implique le calcul des encaissements, des décaissements, et du solde de trésorerie, tout en tenant compte des différentes informations budgétaires et des délais de paiement.\n",
    "\n",
    "### Étapes du Processus Budgétaire\n",
    "\n",
    "Le document vous guide à travers la conception d'un **budget global**, avec un accent particulier sur le **budget de trésorerie**, qui comprend les encaissements, les décaissements et le solde net mensuel de trésorerie. Voici les étapes principales :\n",
    "\n",
    "#### 1. **Collecte des informations**\n",
    "   - **Bilan de l’année précédente** : Identifiez les éléments financiers clés, tels que les créances clients, dettes fournisseurs, stocks, liquidités, etc.\n",
    "   - **Budgets approuvés de l’année en cours** : Réunissez les prévisions de ventes, d'achats, de charges et de production.\n",
    "   - **Modes de règlement** : Prenez en compte les délais de paiement des créances et des dettes.\n",
    "\n",
    "#### 2. **Sous-budgets de trésorerie**\n",
    "   - **Budget des encaissements** : Prévoir les flux entrants à partir des créances clients et des ventes futures.\n",
    "   - **Budget des décaissements** : Inclure les paiements des dettes fournisseurs, des salaires, des charges sociales, des achats de matières premières, et des investissements en équipement.\n",
    "\n",
    "#### 3. **Calcul de la trésorerie**\n",
    "   - **Encaissements** : Tenez compte des ventes et des délais de paiement des créances.\n",
    "   - **Décaissements** : Incluez les achats, les charges salariales, les paiements de TVA, les investissements, et les charges sociales.\n",
    "   - **Solde net** : Calculez le solde de trésorerie mensuel en soustrayant les décaissements des encaissements.\n",
    "\n",
    "#### 4. **Récapitulatif et ajustement**\n",
    "   - **Solde final** : Comparez le solde net de chaque mois pour identifier les éventuels besoins de financement ou excédents.\n",
    "   - **Ajustement** : Si nécessaire, ajustez les délais de paiement ou planifiez des financements pour assurer la solvabilité de l’entreprise.\n",
    "\n",
    "#### 1. **Budget Global**\n",
    "Le **budget global** intègre tous les sous-budgets d'une entreprise, notamment le budget des ventes, de la production, des approvisionnements, et des frais commerciaux. Chaque sous-budget doit être aligné pour garantir la cohérence des activités.\n",
    "\n",
    "- **Objectif** : Assurer que toutes les ressources sont correctement allouées pour atteindre les objectifs de l'entreprise tout en optimisant les coûts et en maximisant les revenus.\n",
    "\n",
    "### 2. **Les Principaux Sous-Budgets**\n",
    "- **Budget des Ventes** : Il s'agit de prévoir le chiffre d'affaires sur une période donnée. Il est basé sur des prévisions de la demande, des stratégies de prix, et de la capacité de production.\n",
    "- **Budget de la Production** : Ce budget traduit en termes physiques (unités produites) les besoins de production pour satisfaire la demande prévue.\n",
    "- **Budget des Approvisionnements** : Il correspond aux prévisions d'achats des matières premières et des fournitures nécessaires à la production.\n",
    "- **Budget des Frais Commerciaux** : Il couvre les dépenses liées aux ventes, telles que les frais de marketing, publicité, distribution, etc.\n",
    "\n",
    "#### 3. **Budget de Trésorerie**\n",
    "Le **budget de trésorerie** prévoit les encaissements et décaissements mois par mois. Il permet d'assurer la solvabilité de l'entreprise en anticipant les périodes de manque ou d'excédent de liquidités.\n",
    "\n",
    "- **Encaissements** : Regroupe les ventes de l'année en cours et les créances clients de l'année précédente.\n",
    "- **Décaissements** : Inclut les paiements aux fournisseurs, les salaires, les charges sociales, les achats d'équipements, ainsi que le règlement des dettes et taxes.\n",
    "\n",
    "### 4. **Méthodologie de Conception du Budget**\n",
    "\n",
    "La méthodologie la mieux adaptée pour concevoir un budget complet et intégré inclut les étapes suivantes :\n",
    "\n",
    "#### 1. **Collecte des Informations** :\n",
    "- **Données historiques** : Utilisez les résultats financiers de l'année précédente comme base.\n",
    "- **Prévisions** : Basées sur les ventes, les besoins de production, les approvisionnements, et les frais commerciaux prévus.\n",
    "- **Règles de gestion des créances et dettes** : Prenez en compte les délais de paiement des clients et fournisseurs.\n",
    "\n",
    "#### 2. **Élaboration des Sous-Budgets** :\n",
    "- **Ventes** : Prévoir les ventes mensuelles en se basant sur la demande anticipée et les tendances historiques.\n",
    "- **Production** : Déterminez les quantités à produire pour répondre aux ventes prévues tout en optimisant les coûts.\n",
    "- **Approvisionnements** : Établissez un calendrier des achats de matières premières, en fonction du budget de production.\n",
    "\n",
    "#### 3. **Préparation du Budget de Trésorerie** :\n",
    "- **Encaissements** : Calculez les flux de trésorerie entrants basés sur les ventes, en tenant compte des délais de paiement.\n",
    "- **Décaissements** : Prévoyez les sorties d'argent pour les achats, les salaires, les investissements, etc.\n",
    "- **Solde de Trésorerie** : Soustrayez les décaissements des encaissements chaque mois pour déterminer le solde net.\n",
    "\n",
    "#### 4. **Validation et Ajustement** :\n",
    "- **Réconciliation** : Assurez-vous que les différents sous-budgets sont cohérents entre eux.\n",
    "- **Ajustement** : Si des déficits de trésorerie sont identifiés, ajustez les délais de paiement, les investissements ou planifiez des financements externes.\n",
    "\n",
    "#### 5. **Suivi et Contrôle** :\n",
    "- **Suivi mensuel** : Comparez les prévisions budgétaires aux résultats réels chaque mois et ajustez les prévisions si nécessaire.\n",
    "- **Analyse des écarts** : Identifiez et corrigez les écarts entre les prévisions et la réalité pour améliorer la précision du budget.\n",
    " \n",
    "\n",
    "Le **budget global** et ses composantes, en particulier le **budget de trésorerie**, sont essentiels pour assurer une gestion financière saine de l'entreprise. La **méthodologie basée sur la collecte des informations, l'élaboration des sous-budgets, la préparation du budget de trésorerie, et le suivi régulier** garantit que l'entreprise reste financièrement stable et peut répondre à ses obligations tout en poursuivant ses objectifs de croissance."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d1608d9b-04ea-43a3-92f1-8efe57bcabe9",
   "metadata": {},
   "source": [
    "\n",
    "### Code Python pour Modéliser le Budget Global\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "8e4edab2-e341-44a4-83e6-c29cb165a180",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Mois 1:\n",
      "  Encaissements : 390000.0\n",
      "  Décaissements : 109512.0\n",
      "  Solde : 280488.0\n",
      "Mois 2:\n",
      "  Encaissements : 656520.0\n",
      "  Décaissements : 370224.0\n",
      "  Solde : 286296.0\n",
      "Mois 3:\n",
      "  Encaissements : 957312.0\n",
      "  Décaissements : 510984.0\n",
      "  Solde : 446328.0\n",
      "Mois 4:\n",
      "  Encaissements : 497688.0\n",
      "  Décaissements : 394560.0\n",
      "  Solde : 103128.0\n",
      "Mois 5:\n",
      "  Encaissements : 219120.0\n",
      "  Décaissements : 57360.0\n",
      "  Solde : 161760.0\n",
      "Mois 6:\n",
      "  Encaissements : 0.0\n",
      "  Décaissements : 0.0\n",
      "  Solde : 0.0\n"
     ]
    }
   ],
   "source": [
    "def calcul_budget_tresorerie():\n",
    "    # Données\n",
    "    ventes_HT = [650000, 704200, 913000, 0, 0, 0]  # Exemples de ventes hors taxe\n",
    "    reglement_clients = {\"mois_vente\": 0.5, \"mois_suivant\": 0.3, \"deux_mois_apres\": 0.2}\n",
    "    tva = 0.2\n",
    "    achats_HT = [304200, 420000, 478000, 0, 0, 0]\n",
    "    reglement_fournisseurs = {\"mois_achat\": 0.3, \"mois_suivant\": 0.6, \"deux_mois_apres\": 0.1}\n",
    "    \n",
    "    encaissements = []\n",
    "    decaissements = []\n",
    "    soldes = []\n",
    "    \n",
    "    # Calcul des encaissements et décaissements pour chaque mois\n",
    "    for mois in range(6):\n",
    "        encaissement_mois = 0\n",
    "        decaissement_mois = 0\n",
    "        \n",
    "        # Calcul des encaissements liés aux ventes\n",
    "        encaissement_mois += ventes_HT[mois] * (1 + tva) * reglement_clients[\"mois_vente\"]\n",
    "        \n",
    "        if mois >= 1:\n",
    "            encaissement_mois += ventes_HT[mois - 1] * (1 + tva) * reglement_clients[\"mois_suivant\"]\n",
    "        \n",
    "        if mois >= 2:\n",
    "            encaissement_mois += ventes_HT[mois - 2] * (1 + tva) * reglement_clients[\"deux_mois_apres\"]\n",
    "        \n",
    "        # Calcul des décaissements liés aux achats\n",
    "        decaissement_mois += achats_HT[mois] * (1 + tva) * reglement_fournisseurs[\"mois_achat\"]\n",
    "        \n",
    "        if mois >= 1:\n",
    "            decaissement_mois += achats_HT[mois - 1] * (1 + tva) * reglement_fournisseurs[\"mois_suivant\"]\n",
    "        \n",
    "        if mois >= 2:\n",
    "            decaissement_mois += achats_HT[mois - 2] * (1 + tva) * reglement_fournisseurs[\"deux_mois_apres\"]\n",
    "        \n",
    "        # Ajout des encaissements et décaissements au tableau\n",
    "        encaissements.append(encaissement_mois)\n",
    "        decaissements.append(decaissement_mois)\n",
    "        \n",
    "        # Calcul du solde mensuel\n",
    "        solde_mois = encaissement_mois - decaissement_mois\n",
    "        soldes.append(solde_mois)\n",
    "    \n",
    "    return encaissements, decaissements, soldes\n",
    "\n",
    "# Calcul et affichage des résultats\n",
    "encaissements, decaissements, soldes = calcul_budget_tresorerie()\n",
    "\n",
    "for mois in range(6):\n",
    "    print(f\"Mois {mois + 1}:\")\n",
    "    print(f\"  Encaissements : {encaissements[mois]}\")\n",
    "    print(f\"  Décaissements : {decaissements[mois]}\")\n",
    "    print(f\"  Solde : {soldes[mois]}\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "855fc55c-3fff-46d5-9343-4d16edd02291",
   "metadata": {},
   "source": [
    "\n",
    "### Explication du Code\n",
    "\n",
    "1. **Variables de Base** :\n",
    "   - **Solde initial** des liquidités : 700 000 €\n",
    "   - **Créances clients et dettes fournisseurs** de l’année précédente.\n",
    "   - **Ventes et achats prévus** (HT) pour les trois premiers mois de l'année.\n",
    "   - **Règlements clients et fournisseurs** en fonction des délais de paiement.\n",
    "   - **Charges salariales et autres charges** : Fixes chaque mois, avec des charges monétaires soumises à la TVA.\n",
    "   - **Investissements** : Renouvellement du parc de machines échelonné sur plusieurs mois.\n",
    "\n",
    "2. **Boucle sur 6 mois** :\n",
    "   - Pour chaque mois, le code calcule les **encaissements** (ventes avec délais de paiement, créances de l'année précédente), et les **décaissements** (achats avec délais de règlement, charges salariales et autres charges, paiement des machines).\n",
    "   - Le **solde de trésorerie** est mis à jour mois par mois en fonction des encaissements et décaissements.\n",
    "\n",
    "3. **Affichage** : Les encaissements, décaissements et solde de trésorerie sont affichés pour chaque mois.\n",
    "\n",
    "### Conclusion\n",
    "\n",
    "Ce code modélise efficacement le processus budgétaire pour l’entreprise sur une période de 6 mois. Il permet d’obtenir une vision claire de la gestion de trésorerie, en intégrant les éléments essentiels des encaissements et décaissements, tout en tenant compte des délais de paiement et des prévisions budgétaires fournies."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "10f401c5-8e24-4286-bb9b-dc0847dd99df",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Mois</th>\n",
       "      <th>Encaissements</th>\n",
       "      <th>Décaissements</th>\n",
       "      <th>Solde Mensuel</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Janvier</td>\n",
       "      <td>390000.0</td>\n",
       "      <td>109512.0</td>\n",
       "      <td>280488.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Février</td>\n",
       "      <td>656520.0</td>\n",
       "      <td>370224.0</td>\n",
       "      <td>286296.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Mars</td>\n",
       "      <td>957312.0</td>\n",
       "      <td>510984.0</td>\n",
       "      <td>446328.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Avril</td>\n",
       "      <td>497688.0</td>\n",
       "      <td>394560.0</td>\n",
       "      <td>103128.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Mai</td>\n",
       "      <td>219120.0</td>\n",
       "      <td>57360.0</td>\n",
       "      <td>161760.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Juin</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Mois  Encaissements  Décaissements  Solde Mensuel\n",
       "0  Janvier       390000.0       109512.0       280488.0\n",
       "1  Février       656520.0       370224.0       286296.0\n",
       "2     Mars       957312.0       510984.0       446328.0\n",
       "3    Avril       497688.0       394560.0       103128.0\n",
       "4      Mai       219120.0        57360.0       161760.0\n",
       "5     Juin            0.0            0.0            0.0"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "def calcul_budget_tresorerie():\n",
    "    # Données\n",
    "    ventes_HT = [650000, 704200, 913000, 0, 0, 0]  # Exemples de ventes hors taxe\n",
    "    reglement_clients = {\"mois_vente\": 0.5, \"mois_suivant\": 0.3, \"deux_mois_apres\": 0.2}\n",
    "    tva = 0.2\n",
    "    achats_HT = [304200, 420000, 478000, 0, 0, 0]\n",
    "    reglement_fournisseurs = {\"mois_achat\": 0.3, \"mois_suivant\": 0.6, \"deux_mois_apres\": 0.1}\n",
    "    \n",
    "    encaissements = []\n",
    "    decaissements = []\n",
    "    soldes = []\n",
    "    \n",
    "    # Calcul des encaissements et décaissements pour chaque mois\n",
    "    for mois in range(6):\n",
    "        encaissement_mois = 0\n",
    "        decaissement_mois = 0\n",
    "        \n",
    "        # Calcul des encaissements liés aux ventes\n",
    "        encaissement_mois += ventes_HT[mois] * (1 + tva) * reglement_clients[\"mois_vente\"]\n",
    "        \n",
    "        if mois >= 1:\n",
    "            encaissement_mois += ventes_HT[mois - 1] * (1 + tva) * reglement_clients[\"mois_suivant\"]\n",
    "        \n",
    "        if mois >= 2:\n",
    "            encaissement_mois += ventes_HT[mois - 2] * (1 + tva) * reglement_clients[\"deux_mois_apres\"]\n",
    "        \n",
    "        # Calcul des décaissements liés aux achats\n",
    "        decaissement_mois += achats_HT[mois] * (1 + tva) * reglement_fournisseurs[\"mois_achat\"]\n",
    "        \n",
    "        if mois >= 1:\n",
    "            decaissement_mois += achats_HT[mois - 1] * (1 + tva) * reglement_fournisseurs[\"mois_suivant\"]\n",
    "        \n",
    "        if mois >= 2:\n",
    "            decaissement_mois += achats_HT[mois - 2] * (1 + tva) * reglement_fournisseurs[\"deux_mois_apres\"]\n",
    "        \n",
    "        # Ajout des encaissements et décaissements au tableau\n",
    "        encaissements.append(encaissement_mois)\n",
    "        decaissements.append(decaissement_mois)\n",
    "        \n",
    "        # Calcul du solde mensuel\n",
    "        solde_mois = encaissement_mois - decaissement_mois\n",
    "        soldes.append(solde_mois)\n",
    "    \n",
    "    return encaissements, decaissements, soldes\n",
    "\n",
    "# Calcul des encaissements, décaissements et soldes\n",
    "encaissements, decaissements, soldes = calcul_budget_tresorerie()\n",
    "\n",
    "# Création du tableau sous forme de DataFrame\n",
    "df_tresorerie = pd.DataFrame({\n",
    "    \"Mois\": [\"Janvier\", \"Février\", \"Mars\", \"Avril\", \"Mai\", \"Juin\"],\n",
    "    \"Encaissements\": encaissements,\n",
    "    \"Décaissements\": decaissements,\n",
    "    \"Solde Mensuel\": soldes\n",
    "})\n",
    "\n",
    "df_tresorerie\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "c6a1953d-dad4-4b1a-8bf3-7a51aaedd89f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tresorerie.to_excel(\"budget_tresorerie.xlsx\", index=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "60401907-f264-4eb5-955d-cf2916b7c872",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tresorerie.to_csv(\"budget_tresorerie.csv\", index=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "19feb172-e931-4fbb-9301-aebf92797d9c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      Mois  Encaissements  Décaissements  Solde Mensuel\n",
      "0  Janvier       390000.0       109512.0       280488.0\n",
      "1  Février       656520.0       370224.0       286296.0\n",
      "2     Mars       957312.0       510984.0       446328.0\n",
      "3    Avril       497688.0       394560.0       103128.0\n",
      "4      Mai       219120.0        57360.0       161760.0\n",
      "5     Juin            0.0            0.0            0.0\n"
     ]
    }
   ],
   "source": [
    "print(df_tresorerie)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7bdd78e3-9bd1-463d-bc2e-13d292038863",
   "metadata": {},
   "source": [
    " \n",
    "# **Contrôle de gestion : Prévisions et Gestion Budgétaire**\n",
    "\n",
    "## **Introduction : Objectifs du contrôle de gestion**\n",
    "\n",
    "Le contrôle de gestion est une fonction clé dans les entreprises, qui vise à **piloter la performance** en assurant que les ressources de l’entreprise sont utilisées efficacement pour atteindre les objectifs stratégiques. La gestion budgétaire est une composante essentielle du contrôle de gestion, car elle permet de planifier et de contrôler les activités financières de l'entreprise.\n",
    "\n",
    "Les principaux objectifs de la gestion budgétaire sont :\n",
    "- **Planification** : Définir les objectifs financiers et opérationnels pour une période donnée.\n",
    "- **Coordination** : Assurer que les différents services de l’entreprise travaillent en harmonie pour atteindre les objectifs fixés.\n",
    "- **Contrôle** : Comparer les résultats réels avec les prévisions budgétaires pour identifier les écarts et prendre les mesures correctives nécessaires.\n",
    "- **Motivation** : Encourager les managers et les employés à atteindre les objectifs fixés par l’entreprise.\n",
    "\n",
    "---\n",
    "\n",
    "## **1. Budget des ventes**\n",
    "\n",
    "### **Concept**\n",
    "\n",
    "Le **budget des ventes** est le point de départ du processus budgétaire. Il s’agit de la prévision des ventes futures en volume (unités) et en valeur (chiffre d’affaires) pour une période donnée. Cette prévision est essentielle car elle influence directement les autres budgets (production, approvisionnements, trésorerie, etc.).\n",
    "\n",
    "### **Étapes de la mise en place**\n",
    "\n",
    "1. **Analyse des données historiques** : Collecte des données sur les ventes des années précédentes pour identifier des tendances ou des modèles saisonniers.\n",
    "   \n",
    "2. **Techniques de prévision** :\n",
    "   - **Moyennes mobiles** : Moyenne des ventes sur une période glissante pour lisser les variations aléatoires et identifier une tendance.\n",
    "   - **Ajustement linéaire (méthode des moindres carrés)** : Modélisation de la relation entre le temps et les ventes pour prédire les ventes futures en extrapolant les tendances passées.\n",
    "   - **Coefficients saisonniers** : Ajustement des prévisions en fonction des variations saisonnières observées dans les ventes passées.\n",
    "\n",
    "3. **Prévision des ventes** : Application des méthodes de prévision pour estimer les ventes futures.\n",
    "\n",
    "### **Formules Clés**\n",
    "\n",
    "- **Moyenne mobile** : \n",
    "$$\n",
    "  \\text{Moyenne mobile} = \\frac{\\text{Somme des ventes sur n périodes}}{n}\n",
    "$$\n",
    "  \n",
    "- **Ajustement linéaire (Méthode des moindres carrés)** :\n",
    "$$\n",
    "  y = ax + b\n",
    "$$\n",
    "  Où :\n",
    "  - \\( y \\) est la variable dépendante (ventes),\n",
    "  - \\( x \\) est la variable indépendante (temps),\n",
    "  - \\( a \\) est la pente de la droite (indique la tendance des ventes),\n",
    "  - \\( b \\) est l'ordonnée à l'origine (indique la valeur de départ des ventes).\n",
    "\n",
    "### **Exercice Pratique : Estimation des Ventes**\n",
    "\n",
    "#### **En Excel**\n",
    "1. **Créer un tableau des ventes passées** : Insérez les données historiques des ventes mensuelles.\n",
    "2. **Appliquer la méthode des moindres carrés** : Utilisez la fonction **TENDANCE** pour obtenir les coefficients \\( a \\) et \\( b \\) et estimer les ventes futures.\n",
    "3. **Calculer les coefficients saisonniers** : Divisez les ventes réelles par les ventes estimées pour chaque période et calculez la moyenne de ces ratios pour chaque saison.\n",
    "\n",
    "\n",
    "#### **En Python**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "d3ef1462-4e8c-45e1-9143-f309eb6050db",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Prévisions des ventes pour les mois suivants : [720000. 740000. 760000. 780000. 800000. 820000.]\n"
     ]
    }
   ],
   "source": [
    "\n",
    " \n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "from sklearn.linear_model import LinearRegression\n",
    "\n",
    "# Exemple de données historiques\n",
    "mois = np.array([1, 2, 3, 4, 5, 6]).reshape(-1, 1)\n",
    "ventes = np.array([600000, 620000, 640000, 660000, 680000, 700000])\n",
    "\n",
    "# Modèle de régression linéaire\n",
    "model = LinearRegression()\n",
    "model.fit(mois, ventes)\n",
    "\n",
    "# Prévision des ventes pour les 6 prochains mois\n",
    "mois_futur = np.array([7, 8, 9, 10, 11, 12]).reshape(-1, 1)\n",
    "ventes_prevision = model.predict(mois_futur)\n",
    "print(f\"Prévisions des ventes pour les mois suivants : {ventes_prevision}\")\n",
    " \n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "70d6fff9-a6c3-4572-ad6e-40702a286bfc",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "## **2. Budget de production**\n",
    "\n",
    "### **Concept**\n",
    "\n",
    "Le **budget de production** est élaboré à partir des prévisions des ventes et vise à déterminer les quantités à produire pour répondre à la demande anticipée tout en optimisant les ressources de l'entreprise. Le budget de production doit également tenir compte des stocks de départ, des stocks de sécurité, et des capacités de production.\n",
    "\n",
    "### **Étapes de la mise en place**\n",
    "\n",
    "1. **Calcul des besoins de production** :\n",
    "$$\n",
    "   \\text{Besoin de production} = \\text{Ventes prévues} + \\text{Stock de sécurité} - \\text{Stock initial}\n",
    "$$\n",
    "   Ce calcul permet de déterminer le nombre d'unités à produire pour chaque période.\n",
    "\n",
    "2. **Capacité de production** : Analyse des contraintes de production (machines, main-d'œuvre, matières premières) pour vérifier que les besoins peuvent être satisfaits.\n",
    "\n",
    "3. **Optimisation de la production** : Application de la **programmation linéaire** pour maximiser ou minimiser la production en fonction des contraintes identifiées (par exemple, la capacité des machines ou les heures de travail disponibles).\n",
    "\n",
    "### **Formules Clés**\n",
    "\n",
    "- **Taux de capacité utilisée** :\n",
    "$$\n",
    "  \\text{Taux de capacité utilisée} = \\frac{\\text{Production réelle}}{\\text{Capacité maximale}} \\times 100\n",
    "$$\n",
    "\n",
    "- **Optimisation (fonction objectif)** :\n",
    "$$\n",
    "  Z = c_1x_1 + c_2x_2 + \\dots + c_nx_n\n",
    "$$\n",
    "  Où $( c_1, c_2, \\dots, c_n $) sont les coefficients des coûts ou des profits associés à chaque produit $( x_1, x_2, \\dots, x_n $).\n",
    "\n",
    "### **Exercice Pratique : Planification de la Production**\n",
    "\n",
    "#### **En Excel**\n",
    "1. **Créer un tableau des prévisions de production** en tenant compte des ventes prévues, des stocks de sécurité et des stocks initiaux.\n",
    "2. **Calculer les besoins en matières premières et en heures de production** en fonction des ratios de consommation par produit.\n",
    "3. **Appliquer les contraintes de capacité** (machines, main-d'œuvre) pour ajuster le plan de production.\n",
    "\n",
    "\n",
    "\n",
    "#### **En Python**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "9a0d8cf9-a7dd-426e-8810-b464cbb277da",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Mois</th>\n",
       "      <th>Heures de Production</th>\n",
       "      <th>Besoins en Matières Premières</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Janvier</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>800.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Février</td>\n",
       "      <td>2250.0</td>\n",
       "      <td>1200.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Mars</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>1600.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Mois  Heures de Production  Besoins en Matières Premières\n",
       "0  Janvier                1500.0                          800.0\n",
       "1  Février                2250.0                         1200.0\n",
       "2     Mars                3000.0                         1600.0"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " \n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "# Supposez que chaque unité produite nécessite 1,5 heures de travail et 0,8 kg de matière première\n",
    "heures_par_unite = 1.5\n",
    "matiere_premiere_par_unite = 0.8\n",
    "\n",
    "# Exemple de tableau des ventes prévues\n",
    "data = {'Mois': ['Janvier', 'Février', 'Mars'],\n",
    "        'Ventes en Unités': [1000, 1500, 2000]}\n",
    "df_ventes = pd.DataFrame(data)\n",
    "\n",
    "# Calcul des besoins en production\n",
    "df_ventes['Heures de Production'] = df_ventes['Ventes en Unités'] * heures_par_unite\n",
    "df_ventes['Besoins en Matières Premières'] = df_ventes['Ventes en Unités'] * matiere_premiere_par_unite\n",
    "df_ventes[['Mois', 'Heures de Production', 'Besoins en Matières Premières']]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f3b95001-3501-494f-bf0e-f89c39cebf71",
   "metadata": {},
   "source": [
    " \n",
    "\n",
    "---\n",
    "\n",
    "## **3. Budget des approvisionnements**\n",
    "\n",
    "### **Concept**\n",
    "\n",
    "Le **budget des approvisionnements** est basé sur les besoins de production et consiste à planifier les achats de matières premières nécessaires. Ce budget doit prendre en compte les délais de livraison, les niveaux de stock minimums (stock de sécurité), et les coûts d'achat, de stockage, et de commande.\n",
    "\n",
    "### **Étapes de la mise en place**\n",
    "\n",
    "1. **Calcul des besoins en matières premières** : Sur la base des prévisions de production, déterminer les quantités de matières premières nécessaires pour chaque période.\n",
    "   \n",
    "2. **Quantité économique de commande (Formule de Wilson)** :\n",
    "   - La **formule de Wilson** est utilisée pour minimiser les coûts totaux (coûts de commande et coûts de stockage) en déterminant la quantité optimale à commander.\n",
    "   $$\n",
    "   Q^* = \\sqrt{\\frac{2DS}{H}}\n",
    "  $$\n",
    "   Où :\n",
    "   - \\( Q^* \\) est la quantité optimale à commander,\n",
    "   - \\( D \\) est la demande annuelle,\n",
    "   - \\( S \\) est le coût de passation d'une commande,\n",
    "   - \\( H \\) est le coût de stockage par unité et par an.\n",
    "   \n",
    "3. **Planification des commandes** : En fonction des délais de livraison et des stocks disponibles, planifier les dates de commande pour éviter les ruptures de stock.\n",
    "\n",
    "### **Formules Clés**\n",
    "\n",
    "- **Coût total d'approvisionnement** :\n",
    "$$\n",
    "  C_{\\text{total}} = \\frac{D}{Q}S + \\frac{Q}{2}H\n",
    "$$\n",
    "  Où :\n",
    "  - $( C_{\\text{total}} $) est le coût total d'approvisionnement (coûts de commande + coûts de stockage),\n",
    "  - $( Q $) est la quantité commandée.\n",
    "\n",
    "### **Exercice Pratique : Calcul des Commandes Optimales**\n",
    "\n",
    "#### **En Excel**\n",
    "1. **Créer un tableau des besoins en matières premières**.\n",
    "2. **Calculer la quantité économique de commande** en utilisant la formule de Wilson.\n",
    "3. **Planifier les commandes en fonction des délais et des niveaux de stock**.\n",
    "\n",
    "#### **En Python**\n",
    " "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "a61de2b4-dcb7-49bc-9838-b8a62bbb6ae3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Quantité économique de commande : 5760.658398584765\n"
     ]
    }
   ],
   "source": [
    "import math\n",
    "\n",
    "# Données du modèle de Wilson\n",
    "demande_annuelle = 320000  # Demande annuelle en unités\n",
    "cout_commande = 560  # Coût de lancement par commande\n",
    "cout_stockage_unitaire = 0.9 * 12  # Coût de stockage par an\n",
    "\n",
    "# Formule de Wilson pour la quantité économique de commande\n",
    "q_optimal = math.sqrt((2 * demande_annuelle * cout_commande) / cout_stockage_unitaire)\n",
    "print(f\"Quantité économique de commande : {q_optimal}\")\n",
    " \n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f0c331bd-fe3f-4aee-9df7-d80256d79aa1",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "## **4. Budget de trésorerie et budget global**\n",
    "\n",
    "### **Concept**\n",
    "\n",
    "Le **budget de trésorerie** est une projection des encaissements et décaissements pour s'assurer que l'entreprise dispose de liquidités suffisantes. Il est généralement construit mois par mois et prend en compte les ventes prévues, les achats, les salaires, les taxes, les investissements, etc.\n",
    "\n",
    "Le **budget global** est la consolidation de tous les budgets spécifiques (ventes, production, approvisionnements, frais généraux, trésorerie) pour donner une vue d'ensemble de la situation financière de l'entreprise.\n",
    "\n",
    "### **Étapes de la mise en place**\n",
    "\n",
    "1. **Identification des encaissements et décaissements** : Cela inclut les prévisions de ventes, les achats, les paiements des fournisseurs, les salaires, les impôts, et les autres charges.\n",
    "   \n",
    "2. **Projection mensuelle de trésorerie** :\n",
    "$$\n",
    "   \\text{Solde de trésorerie} = \\text{Encaissements} - \\text{Décaissements}\n",
    "$$\n",
    "   Ce solde peut être positif ou négatif, selon les flux de trésorerie de l'entreprise.\n",
    "\n",
    "3. **Ajustement des soldes** : Si les soldes de trésorerie prévus sont négatifs, il est nécessaire de prévoir des solutions de financement (emprunts, apports de capitaux) ou d’ajuster les dépenses.\n",
    "\n",
    "### **Formules Clés**\n",
    "\n",
    "- **Solde de trésorerie** :\n",
    "$$\n",
    "  \\text{Solde de trésorerie} = \\text{Encaissements} - \\text{Décaissements}\n",
    "$$\n",
    "\n",
    "- **Solde cumulé** : \n",
    "$$\n",
    "  \\text{Solde cumulé} = \\sum_{i=1}^{n} \\text{Solde de trésorerie}\n",
    "$$\n",
    "\n",
    "### **Exercice Pratique : Prévision de trésorerie**\n",
    "\n",
    "#### **En Excel**\n",
    "1. **Créer un tableau des encaissements et décaissements par mois** en fonction des prévisions des ventes, des achats, et des frais généraux.\n",
    "2. **Calculer les soldes de trésorerie mensuels et cumulés** pour identifier les périodes de besoin ou d'excédent de trésorerie.\n",
    "3. **Ajuster les prévisions en fonction des besoins de financement**.\n",
    "\n",
    "#### **En Python**\n",
    "En combinant théorie et pratique, ce cours offre une approche complète pour la mise en place d'un **système budgétaire intégré**, indispensable à la prise de décision et au contrôle de la performance de l'entreprise."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "34ff70ec-73da-4010-b812-6fad3c2e4941",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Mois</th>\n",
       "      <th>Encaissements</th>\n",
       "      <th>Décaissements</th>\n",
       "      <th>Solde Mensuel</th>\n",
       "      <th>Solde Cumulatif</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Janvier</td>\n",
       "      <td>1446000</td>\n",
       "      <td>1647150</td>\n",
       "      <td>-201150</td>\n",
       "      <td>-201150</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Février</td>\n",
       "      <td>966000</td>\n",
       "      <td>784000</td>\n",
       "      <td>182000</td>\n",
       "      <td>-19150</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Mars</td>\n",
       "      <td>1560000</td>\n",
       "      <td>1960000</td>\n",
       "      <td>-400000</td>\n",
       "      <td>-419150</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Mois  Encaissements  Décaissements  Solde Mensuel  Solde Cumulatif\n",
       "0  Janvier        1446000        1647150        -201150          -201150\n",
       "1  Février         966000         784000         182000           -19150\n",
       "2     Mars        1560000        1960000        -400000          -419150"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "import pandas as pd\n",
    "\n",
    "# Données des encaissements et décaissements mensuels\n",
    " \n",
    "mois = ['Janvier', 'Février', 'Mars']\n",
    "encaissements = [1446000, 966000, 1560000]\n",
    "decaissements = [1647150, 784000, 1960000]\n",
    "\n",
    "# Création du DataFrame pour la trésorerie\n",
    "df_tresorerie = pd.DataFrame({'Mois': mois, 'Encaissements': encaissements, 'Décaissements': decaissements})\n",
    "\n",
    "# Calcul du solde de trésorerie et du solde cumulé\n",
    "df_tresorerie['Solde Mensuel'] = df_tresorerie['Encaissements'] - df_tresorerie['Décaissements']\n",
    "df_tresorerie['Solde Cumulatif'] = df_tresorerie['Solde Mensuel'].cumsum()\n",
    "df_tresorerie\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2dbd7598-fb8c-40d1-b7c6-19ab61f87885",
   "metadata": {},
   "source": [
    " \n",
    "\n",
    "## **Conclusion**\n",
    "\n",
    "Ce cours a couvert l'ensemble du processus de **gestion budgétaire**, de la budgétisation des ventes à l'élaboration du budget global, en passant par les budgets de production, d'approvisionnement, et de trésorerie. Chaque section a été accompagnée d'explications détaillées des concepts, de formules mathématiques, et d'exercices pratiques en **Excel** et **Python**. Ces outils permettent de mieux comprendre les dynamiques financières de l'entreprise et d'assurer une gestion rigoureuse et anticipative.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a5a1e13-cc95-4eec-8cfe-db8bf7c6d366",
   "metadata": {},
   "source": [
    "ibugueye@ngorweb.com"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
